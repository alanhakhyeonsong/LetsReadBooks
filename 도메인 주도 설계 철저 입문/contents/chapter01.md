# 1장. 도메인 주도 설계란?
> 도메인 주도 설계는 에릭 에반스가 자신의 저서 '도메인 주도 설계'에서 최초로 제안한 개념으로, 지금의 소프트웨어 개발에 큰 영향을 미쳤다.

개발자는 소프트웨어 이용자의 세계에 대해 기본적으로 무지하다. 개발자가 이용자들이 겪는 문제를 해결하려면 당연히 이용자의 세계에 대해 배워야 한다. 하지만, 이렇게 배운 지식이 소프트웨어 개발에서 유용한 경우는 드물다.

이용자에게 유용한 소프트웨어를 개발하려면 가치 있는 지식과 그렇지 않은 지식을 신중하게 기분해서 가치 있는 지식만 코드에 녹여 넣어야 한다.

## 가치 있는 지식과 그렇지 않은 지식
가치 있는 지식과 그렇지 않은 지식을 잘 구분하려면,
- 소프트웨어 이용자의 세계를 이해해야 한다.
- 유용한 소프트웨어를 만들려면 이용자의 문제가 무엇인지 파악하고, 이를 해결할 수 있는 최선의 수단을 생각해야 한다.
- **도메인 주도 설계는 이러한 고찰을 반복하는 설계를 통해 이용자의 세계와 소프트웨어 구현을 연결 짓는 것이 그 목적이다.**

## 도메인 지식에 초점을 맞춘 설계 기법
도메인 주도 설계는 이름 그대로 도메인 지식에 초점을 맞춘 설계 기법이다.

**도메인**이란 '영역'이라는 뜻이다. 소프트웨어 개발의 세계에선 **프로그램이 쓰이는 대상 분야**라는 의미로 쓰인다.

예를 들면 다음과 같다.
- 회계 시스템: 금전, 장부
- 물류 시스템: 창고, 화물, 운송수단

소프트웨어의 목적은 도메인에서 이용자들이 직면한 문제를 해결하는 것이다. 이를 위해선, **이용자들의 문제를 정확히 이해하는 것**이 중요하다. 이용자들의 관점이나 생각, 그들이 처한 환경을 제대로 이해해야 하는데 이는 다른 말로 **이용자의 도메인을 접해야 하는 것이다.**

도메인에 속하는 개념과 사건을 이해하고, 그중에서 문제 해결에 유용한 것을 뽑아낸 지식을 소프트웨어에 반영하는 과정은 소프트웨어 개발에 꼭 필요한 과정이다. 주의 깊게 관찰하고 관찰을 통해 알게 된 지식을 제대로 표현하는 것은 소프트웨어 개발 과정의 일부다.

## 도메인 모델링
- 모델: 현실에 일어나는 사건 혹은 개념을 추상화한 개념
- 추상: 여러 사물 혹은 개념에서 공통적인 것을 뽑아 파악하는 것

모델링은 현실의 모든 것을 반영하는 것이 아니라, 상황에 따라 취사 선택이 필요하다. 무엇을 버리고 무엇을 취할지는 도메인에 따라 결정된다.

물류 시스템의 예시로, 트럭은 '화물을 나를 수 있다'는 성질만 표현해도 충분하지 '차 키를 돌리면 엔진에 시동이 걸린다'와 같은 정보까지 나타낼 필요는 없다.

이처럼 **사건 혹은 개념을 추상화하는 작업을 모델링이라 한다.** 그리고 모델링의 결과를 모델이라 한다. 도메인 주도 설계에선 도메인 개념을 모델링한 모델을 도메인 모델이라고 한다.

## 지식을 코드로 나타내는 도메인 객체
도메인 모델은 어디까지나 개념을 추상화한 지식이다. 도메인 모델을 소프트웨어 형태의 동작하는 모듈로 나타낸 것이 도메인 객체다. 어떤 도메인 모델을 도메인 객체로 구현할지도 중요한 문제다.

소프트웨어 이용자가 처한 세계는 항상 같은 상태로만 존재하지 않는다. 모든 것이 시간에 따라 변화하기 쉬운데, 이럴 때 도메인 객체가 도메인 모델을 충실히 반영하고 있다면 도메인의 변화를 코드로 쉽게 옮길 수 있다.

도메인에 발생한 변화는 도메인 모델로 전달되어야 한다.  
도메인 개념이 투영된 도메인 모델은 이 변화를 충실하게 반영할 수 있다. 도메인 객체는 도메인 모델이 구현된 표현이므로 변화한 도메인 모델과 아직 변화하지 않은 도메인 객체를 비교하면 어디를 고쳐야 할지 알 수 있다. 도메인에 일어난 변화는 도메인 모델을 통해 연쇄적으로 도메인 객체까지 전달된다.  
결국 도메인 개념과 도메인 객체는 도메인 모델을 통해 연결되며, 서로 영향을 주고받는 반복적 개발로 실현된다.

## 이 책에서 다루는 패턴
![](https://velog.velcdn.com/images/songs4805/post/2f18e3c6-d885-4726-99c9-97b263497ed5/image.jpg)

- 지식 표현을 위한 패턴
  - 값 객체: 그 도메인만의 고유의 개념(금전, 제조번호 등)을 값으로 나타내는 패턴
  - 엔티티: 값 객체와 마찬가지로 도메인 개념을 나타내기 위한 객체이지만, 다소 차이가 있다.
  - 도메인 서비스: 값 객체나 엔티티만으로는 잘 표현할 수 없는 지식을 다루기 위한 패턴
- 애플리케이션을 구성하기 위한 패턴
  - 리포지토리: 데이터의 저장과 복원을 의미하는 데이터 퍼시스턴시(Data persistency)를 담당하는 객체. RDB와 같은 구체적인 데이터스토어들을 추상화한 개념으로, 데이터 퍼시스턴시를 추상화하면 유연한 애플리케이션을 만들 수 있다.
  - 애플리케이션 서비스: 값 객체, 엔티티, 도메인 서비스, 리포지토리가 서로 협조하며 애플리케이션으로서 기능하는 장소
  - 팩토리: 객체를 만드는 데 필요한 지식에 특화된 객체. 구조가 복잡한 객체를 만드는 방법도 일종의 지식으로 취급하는데, 팩토리 패턴으로 객체 생성에 대한 지식을 한 곳에 모아놓으면 도메인 객체가 더 잘 드러나며 그만큼 코드의 의도를 쉽게 이해할 수 있다.
- 지식 표현을 위한 고급 패턴
  - 애그리게이트: 무결성을 유지하는 경계.
  - 명세: 객체를 평가하기 위한 지식.