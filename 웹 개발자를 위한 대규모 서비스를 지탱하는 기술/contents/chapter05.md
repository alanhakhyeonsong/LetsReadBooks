# Chapter 5 - 대규모 데이터 처리 실전 입문
## 용도 특화형 인덱싱
### 인덱스와 시스템 구성 - RDBMS의 한계가 보일 때
대규모 데이터를 다룰 경우로 전문 검색이나 유사문서계열 탐색, 데이터마이닝 같은 경우엔 많은 경우엔 RDBMS로는 한계가 있다. 배치 처리로 RDBMS에서 데이터를 추출해 별도의 인덱스 서버와 같은 것을 만들고, 이 인덱스 서버에 웹 애플리케이션에서 API로 액세스하는 방법을 사용한다.

![](https://github.com/alanhakhyeonsong/LetsReadBooks/assets/60968342/be50b7d9-7de8-447c-8924-a2aebb7dcdf8)

### 튜닝한 데이터 구조 사용하기
용도 특화형 인덱싱을 하면 RDBMS에선 어려운 일이 가능해진다. RDBMS라는 것은 데이터를 정렬하거나, 통계처리가 가능하거나, `JOIN` 하는 등 범용적인 용도로 만들어져 있다. 다시 말해, 다양한 목적에 사용할 수 있도록 만들어져 있다. 뭔가 특정한 목적으로만 사용하고자 할 때에는 특정한 목적만으로 사용할 수 있도록 튜닝한 데이터 구조를 사용하면 압도적으로 빠르다.

- 용도 특화형 인덱싱
  - 데이터를 정기적으로 뽑아낸다.
  - 뽑아낸 데이터에서 데이터 구조를 구축
    - 검색용 역 인덱스
    - 키워드 링크용 Trie 등
  - 구조화 데이터를 저장한 서버를 C++로 개발, RPC로 액세스

### ex) 하테나 키워드에 의한 링크
특정 문서가 20만 이상의 키워드 중 무엇을 포함하는지를 찾아야만 할 때 일일이 DB 내에 있는 키워드 목록과 사용자가 작성한 내용을 맞춰보게 되면 DB에 과부하가 걸리게 된다.

그래서 배치 처리로 20만 건의 키워드를 추출해둔다. 예전에는 이로부터 굉장히 거대한 정규표현을 만들었다. 10만 건의 정규표현이 들어간 거대한 파일을 만들어 이를 메모리에 읽어들인 후 매칭시켜 나아갔다. 단, 정규표현에는 오토마톤 중 NFA 특성으로 인해 OR로 연결하면 매칭할 때 계산량이 상당히 방대해져서 속도가 나지 않는 문제가 있다. DB에 직접 질의하는 것보다 빠르지만, 정규표현만이라면 힘들어서 안 되므로 현재는 Trie 기반의 정규표현을 사용해서 Common Prefix Search를 수행한다.

### ex) 하테나 북마크의 텍스트 분류기
하테나 북마크는 기사의 카테고리에 대해 Complement Naive Bayes라는 알고리즘을 사용해 자동으로 기계학습을 통해 분류하고 있다. 이 알고리즘을 사용할 때에는 문서에 포함된 단어의 출현확률이 필요하다. 문서의 카테고리를 판정할 때 이것을 하나하나 DB에 어떤 단어가 들어있고 '이건 몇 건'이라는 것을 질의하다보면 시간이 상당히 걸리므로, 출현확률, 실제로는 출현빈도만을 저장하는 서버를 가동해둔다. 이 서버에 질의하면 순식간에 응답이 반환된다.

### 전문 검색엔진
- 대량의 데이터에서 검색하고자 한다.
- 빠르게 검색하고자 한다.
- '좋은 느낌'과 같은 문서를 상위로
  - 스코어링 처리를 수행한다.