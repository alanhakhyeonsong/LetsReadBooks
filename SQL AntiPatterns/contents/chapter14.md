# 14장. 모르는 것에 대한 두려움
### 목표: 누락된 값을 구분하기
SQL 테이블과 쿼리에서 `NULL` 값을 생산적으로 사용할 수 있는 다양한 방법이 있다. 목표는 `NULL`을 포함하는 컬럼에 대한 쿼리를 작성하는 것이다.

- 여전히 일하고 있는 직원의 퇴사일과 같이, 행을 생성할 때 값을 알 수 없는 곳에 `NULL`을 사용할 수 있다.
- 전기만 사용하는 자동차에 대한 연료 효율과 같이, 주어진 컬럼이 주어진 행에서 적용 가능한 값이 없는 경우 `NULL` 값을 사용할 수 있다.
- 함수에 인수로 `DAY('2009-12-32')`와 같이 유효하지 않은 값이 입력되는 경우 `NULL`을 리턴할 수 있다.
- 외부 조인에서 매치되지 않는 행의 컬럼 값의 자리를 채우는데 `NULL` 값을 사용한다.

### 안티패턴: NULL을 일반 값처럼 사용
대부분의 프로그래밍 언어에서와는 달리 SQL에선 `NULL`을 0이나 false 또는 빈 문자열과 다른 특별한 값으로 취급한다. 다음 사항들에 대해 신중하게 생각하자.
- 수식에서 `NULL` 사용
  - 표준 SQL에선 어떤 문자열이든 `NULL`과 연결하면 `NULL`이 된다.
- `NULL`을 가질 수 있는 컬럼 검색
  - `WHERE` 조건에 컬럼에 대해 값을 할당하거나 `NOT` 조건을 넣더라도 `NULL` 값에 대한 로우는 검색이 안된다.
  - 게다가 `WHERE` 절에서 `NULL` 비교 자체도 의미없다.
- 쿼리 파라미터로 `NULL` 사용
  - 일반 값을 넣으면 예측 가능하지만, `NULL`은 파라미터로 지정할 수 없다.
- 문제 회피하기
  - `NULL`을 회피하기 위해 `NOT NULL` 제약 조건을 두고 대체할만한 다른 값 (가령 -1)을 사용하면 문제가 되는 경우가 있다.
  - 다른 컬럼에선 해당 대체 값이 중요할 수 있다.

### 안티패턴 인식 방법
- "`assigned_to` (또는 다른) 컬럼에 아무 값도 설정되지 않은 행을 어떻게 찾을 수 있지?"
- "애플리케이션에서 몇몇 사용자의 전체 이름이 표시되지 않아. 데이터베이스에선 분명 볼 수 있는데"
- "이 프로젝트의 전체 작업시간 보고서에 우리가 완료한 몇몇 버그만 포함되어 있어! 그러니까 우선순위를 할당한 것들만 포함이 되어 있네."
- "Bugs 테이블에서 '알수 없음'을 나타내는 데 예전에 사용하던 문자열을 사용할 수 없다는 것을 확인했기 때문에, 다른 어떤 값을 사용해야 할 지 그리고 데이터를 변환해서 우리 코드가 새로운 값을 사용하도록 하는 데 개발 기간이 얼마나 필요할지 논의하기 위한 회의가 필요해."

### 안티패턴 사용이 합당한 경우
- `NULL`을 사용하는 건 안티패턴이 아니고, `NULL`을 일반적인 값처럼 사용하거나 일반적인 값을 `NULL`처럼 사용하는 것이 안티패턴이다.
- 외부 데이터를 불러오거나 데이터를 내보낼 땐 `NULL`을 일반적인 값처럼 취급해야 한다.
- 누락된 값에 여러 가지 구분이 있을 때는 `NULL`을 사용할 수 없다.

### 해법: 유일한 값으로 NULL을 사용하라
- 스칼라 수식에서의 `NULL`
![image](https://github.com/user-attachments/assets/b1d89523-81aa-4675-b5e4-a3519407661c)

- 불리언 수식에서의 `NULL`
![image](https://github.com/user-attachments/assets/b1d89523-81aa-4675-b5e4-a3519407661c)

- `NULL` 검색하기

```sql
SELECT * FROM Bugs WHERE assigned_to IS NULL;
SELECT * FROM Bugs WHERE assigned_to IS NOT NULL;

SELECT * FROM Bugs WHERE assigned_to IS NULL OR assigned_to <> 1;
SELECT * FROM Bugs WHERE assigned_to IS DISTINCT FROM 1;
```

- 컬럼을 `NOT NULL`로 선언하기
  - `NULL` 값이 애플리케이션 정책을 위반하거나 또는 의미가 없는 경우엔 컬럼에 `NOT NULL` 제약조건을 선언하는 것이 권장사항이다.
- 동적 디폴트