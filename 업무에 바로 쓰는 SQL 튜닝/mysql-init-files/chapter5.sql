====================================================================================
== 5.1.1. ==========================================================================
====================================================================================
* SQL
SELECT 사원.사원번호, 
       급여.평균연봉, 
         급여.최고연봉, 
         급여.최저연봉
 FROM 사원,
       ( SELECT 사원번호,
            ROUND(AVG(연봉),0) 평균연봉,
                  ROUND(MAX(연봉),0) 최고연봉,
                  ROUND(MIN(연봉),0) 최저연봉
             FROM 급여
            GROUP BY 사원번호
       ) 급여
WHERE 사원.사원번호 = 급여.사원번호
AND 사원.사원번호 BETWEEN 10001 AND 10100;

* 결과
+----------+----------+----------+----------+
| 사원번호 | 평균연봉 | 최고연봉 | 최저연봉 |
+----------+----------+----------+----------+
|    10001 |    75389 |    88958 |    60117 |
|    10002 |    68855 |    72527 |    65828 |
|    10003 |    43030 |    43699 |    40006 |
|    10004 |    56512 |    74057 |    40054 |
|    10005 |    87276 |    94692 |    78228 |
|    10006 |    50515 |    60098 |    40000 |
|    10007 |    70827 |    88070 |    56724 |
|    10008 |    49308 |    52668 |    46671 |
|    10009 |    78285 |    94443 |    60929 |
|    10010 |    76723 |    80324 |    72488 |
|    10011 |    49782 |    56753 |    42365 |
|    10012 |    46903 |    54794 |    40000 |
|    10013 |    52432 |    68901 |    40000 |
|    10014 |    52990 |    60598 |    46168 |
|    10015 |    40000 |    40000 |    40000 |
|    10016 |    74995 |    77935 |    70889 |
|    10017 |    87065 |    99651 |    71380 |
|    10018 |    68640 |    84672 |    55881 |
|    10019 |    47007 |    50032 |    44276 |
|    10020 |    43278 |    47017 |    40000 |
|    10021 |    68650 |    84169 |    55025 |
|    10022 |    40428 |    41348 |    39935 |
|    10023 |    49438 |    50319 |    47883 |
|    10024 |    90572 |    96646 |    83733 |
|    10025 |    51959 |    57585 |    40000 |
|    10026 |    58253 |    66313 |    47585 |
|    10027 |    43319 |    46145 |    39520 |
|    10028 |    54142 |    58502 |    48859 |
|    10029 |    71870 |    77777 |    63163 |
|    10030 |    78853 |    88806 |    66956 |
|    10031 |    48178 |    56689 |    40000 |
|    10032 |    56634 |    69539 |    48426 |
|    10033 |    55988 |    60433 |    51258 |
|    10034 |    51543 |    53164 |    47561 |
|    10035 |    55906 |    68755 |    41538 |
|    10036 |    54160 |    63053 |    42819 |
|    10037 |    50413 |    60992 |    39765 |
|    10038 |    55665 |    64254 |    40000 |
|    10039 |    53052 |    63918 |    40000 |
|    10040 |    62092 |    72668 |    52153 |
|    10041 |    70343 |    81705 |    56893 |
|    10042 |    88329 |    95035 |    81662 |
|    10043 |    64417 |    77659 |    49324 |
|    10044 |    50801 |    58345 |    40919 |
|    10045 |    44556 |    47984 |    41971 |
|    10046 |    49502 |    62218 |    40000 |
|    10047 |    69665 |    81037 |    54982 |
|    10048 |    39754 |    40000 |    39507 |
|    10049 |    43365 |    51326 |    39735 |
|    10050 |    88987 |    97830 |    74366 |
|    10051 |    57594 |    64905 |    48817 |
|    10052 |    61815 |    67156 |    56908 |
|    10053 |    73346 |    78478 |    67854 |
|    10054 |    46357 |    53906 |    40000 |
|    10055 |    85483 |    90843 |    80024 |
|    10056 |    62168 |    74722 |    48857 |
|    10057 |    60253 |    68061 |    49616 |
|    10058 |    63303 |    72542 |    52787 |
|    10059 |    84431 |    94161 |    71218 |
|    10060 |    81555 |    93188 |    74686 |
|    10061 |    82247 |    97338 |    68577 |
|    10062 |    63594 |    68784 |    55685 |
|    10063 |    58313 |    74841 |    40000 |
|    10064 |    42775 |    48454 |    39551 |
|    10065 |    42725 |    47437 |    40000 |
|    10066 |    88558 |   103672 |    69736 |
|    10067 |    64081 |    83254 |    44642 |
|    10068 |   101224 |   113229 |    87964 |
|    10069 |    74965 |    86641 |    67675 |
|    10070 |    75166 |    96322 |    55999 |
|    10071 |    44851 |    53315 |    40000 |
|    10072 |    52682 |    64726 |    39567 |
|    10073 |    56473 |    56473 |    56473 |
|    10074 |    71721 |    80820 |    61714 |
|    10075 |    52226 |    67492 |    43590 |
|    10076 |    56337 |    62921 |    47319 |
|    10077 |    47678 |    54699 |    40000 |
|    10078 |    50940 |    54652 |    46833 |
|    10079 |    59053 |    67231 |    53492 |
|    10080 |    64140 |    72729 |    54916 |
|    10081 |    67265 |    79351 |    55786 |
|    10082 |    48935 |    48935 |    48935 |
|    10083 |    59606 |    77186 |    40000 |
|    10084 |    82092 |    93621 |    69811 |
|    10085 |    50348 |    60910 |    40000 |
|    10086 |    86675 |    96471 |    80934 |
|    10087 |    99015 |   102651 |    96750 |
|    10088 |    80508 |    98003 |    65957 |
|    10089 |    66329 |    77955 |    56040 |
|    10090 |    59204 |    75401 |    44978 |
|    10091 |    47918 |    60014 |    40000 |
|    10092 |    60056 |    66803 |    53977 |
|    10093 |    75089 |    82715 |    67856 |
|    10094 |    70947 |    85225 |    58001 |
|    10095 |    70909 |    80955 |    63668 |
|    10096 |    64945 |    68612 |    61395 |
|    10097 |    57068 |    70161 |    44886 |
|    10098 |    48210 |    56202 |    40000 |
|    10099 |    83902 |    98538 |    68781 |
|    10100 |    64537 |    74957 |    54398 |
+----------+----------+----------+----------+
100 rows in set (2.36 sec)

====================================================================================
* SQL
EXPLAIN
SELECT 사원.사원번호, 
       급여.평균연봉, 
         급여.최고연봉, 
         급여.최저연봉
 FROM 사원,
       ( SELECT 사원번호,
            ROUND(AVG(연봉),0) 평균연봉,
                  ROUND(MAX(연봉),0) 최고연봉,
                  ROUND(MIN(연봉),0) 최저연봉
             FROM 급여
            GROUP BY 사원번호
       ) 급여
WHERE 사원.사원번호 = 급여.사원번호
AND 사원.사원번호 BETWEEN 10001 AND 10100;


* 결과
+----+-------------+------------+------------+-------+--------------------+-------------+---------+----------------------+---------+----------+--------------------------+
| id | select_type | table      | partitions | type  | possible_keys      | key         | key_len | ref                  | rows    | filtered | Extra                    |
+----+-------------+------------+------------+-------+--------------------+-------------+---------+----------------------+---------+----------+--------------------------+
|  1 | PRIMARY     | 사원       | NULL       | range | PRIMARY            | PRIMARY     | 4       | NULL                 |     100 |   100.00 | Using where; Using index |
|  1 | PRIMARY     | <derived2> | NULL       | ref   | <auto_key0>        | <auto_key0> | 4       | tuning.사원.사원번호 |      10 |   100.00 | NULL                     |
|  2 | DERIVED     | 급여       | NULL       | index | PRIMARY,I_사용여부 | PRIMARY     | 7       | NULL                 | 2838731 |   100.00 | NULL                     |
+----+-------------+------------+------------+-------+--------------------+-------------+---------+----------------------+---------+----------+--------------------------+
3 rows in set, 1 warning (0.00 sec)
====================================================================================
* SQL
SELECT count(1) from 사원;

* 결과
+----------+
| count(1) |
+----------+
|   300024 |
+----------+
1 row in set (18.43 sec)
====================================================================================
* SQL
SELECT count(1) from 사원 where 사원번호 BETWEEN 10001 AND 10100;

* 결과
+----------+
| count(1) |
+----------+
|      100 |
+----------+
1 row in set (0.00 sec)

====================================================================================
* SQL
SELECT 사원.사원번호,
       ( SELECT ROUND(AVG(연봉),0)
           FROM 급여 as 급여1
          WHERE 사원번호 = 사원.사원번호
       ) AS 평균연봉,
       ( SELECT ROUND(MAX(연봉),0)
           FROM 급여 as 급여2
          WHERE 사원번호 = 사원.사원번호
       ) AS 최고연봉,
       ( SELECT ROUND(MIN(연봉),0)
           FROM 급여 as 급여3
          WHERE 사원번호 = 사원.사원번호
       ) AS 최저연봉
  FROM 사원
 WHERE 사원.사원번호 BETWEEN 10001 AND 10100;

* 결과
+----------+----------+----------+----------+
| 사원번호 | 평균연봉 | 최고연봉 | 최저연봉 |
+----------+----------+----------+----------+
|    10001 |    75389 |    88958 |    60117 |
|    10002 |    68855 |    72527 |    65828 |
|    10003 |    43030 |    43699 |    40006 |
|    10004 |    56512 |    74057 |    40054 |
|    10005 |    87276 |    94692 |    78228 |
|    10006 |    50515 |    60098 |    40000 |
|    10007 |    70827 |    88070 |    56724 |
|    10008 |    49308 |    52668 |    46671 |
|    10009 |    78285 |    94443 |    60929 |
|    10010 |    76723 |    80324 |    72488 |
|    10011 |    49782 |    56753 |    42365 |
|    10012 |    46903 |    54794 |    40000 |
|    10013 |    52432 |    68901 |    40000 |
|    10014 |    52990 |    60598 |    46168 |
|    10015 |    40000 |    40000 |    40000 |
|    10016 |    74995 |    77935 |    70889 |
|    10017 |    87065 |    99651 |    71380 |
|    10018 |    68640 |    84672 |    55881 |
|    10019 |    47007 |    50032 |    44276 |
|    10020 |    43278 |    47017 |    40000 |
|    10021 |    68650 |    84169 |    55025 |
|    10022 |    40428 |    41348 |    39935 |
|    10023 |    49438 |    50319 |    47883 |
|    10024 |    90572 |    96646 |    83733 |
|    10025 |    51959 |    57585 |    40000 |
|    10026 |    58253 |    66313 |    47585 |
|    10027 |    43319 |    46145 |    39520 |
|    10028 |    54142 |    58502 |    48859 |
|    10029 |    71870 |    77777 |    63163 |
|    10030 |    78853 |    88806 |    66956 |
|    10031 |    48178 |    56689 |    40000 |
|    10032 |    56634 |    69539 |    48426 |
|    10033 |    55988 |    60433 |    51258 |
|    10034 |    51543 |    53164 |    47561 |
|    10035 |    55906 |    68755 |    41538 |
|    10036 |    54160 |    63053 |    42819 |
|    10037 |    50413 |    60992 |    39765 |
|    10038 |    55665 |    64254 |    40000 |
|    10039 |    53052 |    63918 |    40000 |
|    10040 |    62092 |    72668 |    52153 |
|    10041 |    70343 |    81705 |    56893 |
|    10042 |    88329 |    95035 |    81662 |
|    10043 |    64417 |    77659 |    49324 |
|    10044 |    50801 |    58345 |    40919 |
|    10045 |    44556 |    47984 |    41971 |
|    10046 |    49502 |    62218 |    40000 |
|    10047 |    69665 |    81037 |    54982 |
|    10048 |    39754 |    40000 |    39507 |
|    10049 |    43365 |    51326 |    39735 |
|    10050 |    88987 |    97830 |    74366 |
|    10051 |    57594 |    64905 |    48817 |
|    10052 |    61815 |    67156 |    56908 |
|    10053 |    73346 |    78478 |    67854 |
|    10054 |    46357 |    53906 |    40000 |
|    10055 |    85483 |    90843 |    80024 |
|    10056 |    62168 |    74722 |    48857 |
|    10057 |    60253 |    68061 |    49616 |
|    10058 |    63303 |    72542 |    52787 |
|    10059 |    84431 |    94161 |    71218 |
|    10060 |    81555 |    93188 |    74686 |
|    10061 |    82247 |    97338 |    68577 |
|    10062 |    63594 |    68784 |    55685 |
|    10063 |    58313 |    74841 |    40000 |
|    10064 |    42775 |    48454 |    39551 |
|    10065 |    42725 |    47437 |    40000 |
|    10066 |    88558 |   103672 |    69736 |
|    10067 |    64081 |    83254 |    44642 |
|    10068 |   101224 |   113229 |    87964 |
|    10069 |    74965 |    86641 |    67675 |
|    10070 |    75166 |    96322 |    55999 |
|    10071 |    44851 |    53315 |    40000 |
|    10072 |    52682 |    64726 |    39567 |
|    10073 |    56473 |    56473 |    56473 |
|    10074 |    71721 |    80820 |    61714 |
|    10075 |    52226 |    67492 |    43590 |
|    10076 |    56337 |    62921 |    47319 |
|    10077 |    47678 |    54699 |    40000 |
|    10078 |    50940 |    54652 |    46833 |
|    10079 |    59053 |    67231 |    53492 |
|    10080 |    64140 |    72729 |    54916 |
|    10081 |    67265 |    79351 |    55786 |
|    10082 |    48935 |    48935 |    48935 |
|    10083 |    59606 |    77186 |    40000 |
|    10084 |    82092 |    93621 |    69811 |
|    10085 |    50348 |    60910 |    40000 |
|    10086 |    86675 |    96471 |    80934 |
|    10087 |    99015 |   102651 |    96750 |
|    10088 |    80508 |    98003 |    65957 |
|    10089 |    66329 |    77955 |    56040 |
|    10090 |    59204 |    75401 |    44978 |
|    10091 |    47918 |    60014 |    40000 |
|    10092 |    60056 |    66803 |    53977 |
|    10093 |    75089 |    82715 |    67856 |
|    10094 |    70947 |    85225 |    58001 |
|    10095 |    70909 |    80955 |    63668 |
|    10096 |    64945 |    68612 |    61395 |
|    10097 |    57068 |    70161 |    44886 |
|    10098 |    48210 |    56202 |    40000 |
|    10099 |    83902 |    98538 |    68781 |
|    10100 |    64537 |    74957 |    54398 |
+----------+----------+----------+----------+
100 rows in set (0.00 sec)
====================================================================================
====================================================================================
* SQL
EXPLAIN
SELECT 사원.사원번호,
       ( SELECT ROUND(AVG(연봉),0)
           FROM 급여 as 급여1
          WHERE 사원번호 = 사원.사원번호
       ) AS 평균연봉,
       ( SELECT ROUND(MAX(연봉),0)
           FROM 급여 as 급여2
          WHERE 사원번호 = 사원.사원번호
       ) AS 최고연봉,
       ( SELECT ROUND(MIN(연봉),0)
           FROM 급여 as 급여3
          WHERE 사원번호 = 사원.사원번호
       ) AS 최저연봉
  FROM 사원
 WHERE 사원.사원번호 BETWEEN 10001 AND 10100;
 
* 결과
+----+--------------------+-------+------------+-------+------------------------------+---------+---------+----------------------+------+----------+--------------------------+
| id | select_type        | table | partitions | type  | possible_keys                | key     | key_len | ref                  | rows | filtered | Extra                    |
+----+--------------------+-------+------------+-------+------------------------------+---------+---------+----------------------+------+----------+--------------------------+
|  1 | PRIMARY            | 사원  | NULL       | range | PRIMARY,I_입사일자,I_성별_성 | PRIMARY | 4       | NULL                 |  100 |   100.00 | Using where; Using index |
|  4 | DEPENDENT SUBQUERY | 급여3 | NULL       | ref   | PRIMARY                      | PRIMARY | 4       | tuning.사원.사원번호 |    9 |   100.00 | NULL                     |
|  3 | DEPENDENT SUBQUERY | 급여2 | NULL       | ref   | PRIMARY                      | PRIMARY | 4       | tuning.사원.사원번호 |    9 |   100.00 | NULL                     |
|  2 | DEPENDENT SUBQUERY | 급여1 | NULL       | ref   | PRIMARY                      | PRIMARY | 4       | tuning.사원.사원번호 |    9 |   100.00 | NULL                     |
+----+--------------------+-------+------------+-------+------------------------------+---------+---------+----------------------+------+----------+--------------------------+

4 rows in set, 4 warnings (0.00 sec)
====================================================================================
== 5.1.2. ==========================================================================
====================================================================================
* SQL
SELECT 사원.사원번호, 사원.이름, 사원.성, 사원.입사일자
  FROM 사원,
       급여       
 WHERE 사원.사원번호 = 급여.사원번호
   AND 사원.사원번호 BETWEEN 10001 AND 50000
 GROUP BY 사원.사원번호
 ORDER BY SUM(급여.연봉) DESC
 LIMIT 150,10;
 
* 결과
+----------+----------+---------------+------------+
| 사원번호 | 이름     | 성            | 입사일자   |
+----------+----------+---------------+------------+
|    34821 | Gila     | Suomi         | 1985-02-20 |
|    30351 | Djenana  | Blokdijk      | 1985-07-15 |
|    15598 | Kristinn | Kemmerer      | 1986-10-07 |
|    20817 | Yucai    | Albarhamtoshy | 1986-12-27 |
|    30249 | Aran     | Bridgland     | 1985-03-31 |
|    21465 | Shalesh  | Terwilliger   | 1985-03-05 |
|    13916 | Vidya    | Wynblatt      | 1986-06-06 |
|    49465 | Chenyi   | Schusler      | 1989-02-15 |
|    33197 | Dmitry   | Riefers       | 1985-04-07 |
|    43888 | Sushant  | Baalen        | 1985-12-24 |
+----------+----------+---------------+------------+
10 rows in set (0.41 sec)

====================================================================================
* SQL
EXPLAIN
SELECT 사원.사원번호, 사원.이름, 사원.성, 사원.입사일자
  FROM 사원,
       급여       
 WHERE 사원.사원번호 = 급여.사원번호
   AND 사원.사원번호 BETWEEN 10001 AND 50000
 GROUP BY 사원.사원번호
 ORDER BY SUM(급여.연봉) DESC
 LIMIT 150,10;
 
* 결과
+----+-------------+-------+------------+-------+------------------------------+---------+---------+----------------------+-------+----------+----------------------------------------------+
| id | select_type | table | partitions | type  | possible_keys                | key     | key_len | ref                  | rows  | filtered | Extra                                        |
+----+-------------+-------+------------+-------+------------------------------+---------+---------+----------------------+-------+----------+----------------------------------------------+
|  1 | SIMPLE      | 사원  | NULL       | range | PRIMARY,I_입사일자,I_성별_성 | PRIMARY | 4       | NULL                 | 79652 |   100.00 | Using where; Using temporary; Using filesort |
|  1 | SIMPLE      | 급여  | NULL       | ref   | PRIMARY                      | PRIMARY | 4       | tuning.사원.사원번호 |     9 |   100.00 | NULL                                         |
+----+-------------+-------+------------+-------+------------------------------+---------+---------+----------------------+-------+----------+----------------------------------------------+
2 rows in set, 1 warning (0.01 sec)
====================================================================================
* SQL
SELECT 사원.사원번호, 사원.이름, 사원.성, 사원.입사일자
  FROM (SELECT 사원번호
          FROM 급여
           WHERE 사원번호 BETWEEN 10001 AND 50000
           GROUP BY 사원번호
           ORDER BY SUM(급여.연봉) DESC
           LIMIT 150,10) 급여,
        사원
 WHERE 사원.사원번호 = 급여.사원번호;

* 결과
+----------+----------+---------------+------------+
| 사원번호 | 이름     | 성            | 입사일자   |
+----------+----------+---------------+------------+
|    34821 | Gila     | Suomi         | 1985-02-20 |
|    30351 | Djenana  | Blokdijk      | 1985-07-15 |
|    15598 | Kristinn | Kemmerer      | 1986-10-07 |
|    20817 | Yucai    | Albarhamtoshy | 1986-12-27 |
|    30249 | Aran     | Bridgland     | 1985-03-31 |
|    21465 | Shalesh  | Terwilliger   | 1985-03-05 |
|    13916 | Vidya    | Wynblatt      | 1986-06-06 |
|    49465 | Chenyi   | Schusler      | 1989-02-15 |
|    33197 | Dmitry   | Riefers       | 1985-04-07 |
|    43888 | Sushant  | Baalen        | 1985-12-24 |
+----------+----------+---------------+------------+
10 rows in set (0.21 sec)
====================================================================================
* SQL
EXPLAIN
SELECT 사원.사원번호, 사원.이름, 사원.성, 사원.입사일자
  FROM (SELECT 사원번호
          FROM 급여
           WHERE 사원번호 BETWEEN 10001 AND 50000
           GROUP BY 사원번호
           ORDER BY SUM(급여.연봉) DESC
           LIMIT 150,10) 급여,
        사원
 WHERE 사원.사원번호 = 급여.사원번호;
 
* 결과
+----+-------------+------------+------------+--------+--------------------+---------+---------+---------------+--------+----------+----------------------------------------------+
| id | select_type | table      | partitions | type   | possible_keys      | key     | key_len | ref           | rows   | filtered | Extra                                        |
+----+-------------+------------+------------+--------+--------------------+---------+---------+---------------+--------+----------+----------------------------------------------+
|  1 | PRIMARY     | <derived2> | NULL       | ALL    | NULL               | NULL    | NULL    | NULL          |    160 |   100.00 | NULL                                         |
|  1 | PRIMARY     | 사원       | NULL       | eq_ref | PRIMARY            | PRIMARY | 4       | 급여.사원번호 |      1 |   100.00 | NULL                                         |
|  2 | DERIVED     | 급여       | NULL       | range  | PRIMARY,I_사용여부 | PRIMARY | 4       | NULL          | 779148 |   100.00 | Using where; Using temporary; Using filesort |
+----+-------------+------------+------------+--------+--------------------+---------+---------+---------------+--------+----------+----------------------------------------------+
3 rows in set, 1 warning (0.01 sec)
====================================================================================
== 5.1.3 ===========================================================================
====================================================================================
* SQL
SELECT COUNT(사원번호) AS 카운트
  FROM (
         SELECT 사원.사원번호, 부서관리자.부서번호
           FROM ( SELECT *
                   FROM 사원
                  WHERE 성별= 'M'
                    AND 사원번호 > 300000
                ) 사원
           LEFT JOIN 부서관리자
                 ON 사원.사원번호 = 부서관리자.사원번호
       ) 서브쿼리;

* 결과
+--------+
| 카운트 |
+--------+
|  60108 |
+--------+
1 row in set (0.15 sec)

====================================================================================
* SQL
EXPLAIN
SELECT COUNT(사원번호) AS 카운트
  FROM (
         SELECT 사원.사원번호, 부서관리자.부서번호
           FROM ( SELECT *
                   FROM 사원
                  WHERE 성별= 'M'
                    AND 사원번호 > 300000
                ) 사원
           LEFT JOIN 부서관리자
                 ON 사원.사원번호 = 부서관리자.사원번호
       ) 서브쿼리;
	   
* 결과
+----+-------------+------------+------------+------+-------------------+-----------+---------+----------------------+--------+----------+--------------------------+
| id | select_type | table      | partitions | type | possible_keys     | key       | key_len | ref                  | rows   | filtered | Extra                    |
+----+-------------+------------+------------+------+-------------------+-----------+---------+----------------------+--------+----------+--------------------------+
|  1 | SIMPLE      | 사원       | NULL       | ref  | PRIMARY,I_성별_성 | I_성별_성 | 1       | const                | 149578 |    50.00 | Using where; Using index |
|  1 | SIMPLE      | 부서관리자 | NULL       | ref  | PRIMARY           | PRIMARY   | 4       | tuning.사원.사원번호 |      1 |   100.00 | Using index              |
+----+-------------+------------+------------+------+-------------------+-----------+---------+----------------------+--------+----------+--------------------------+
2 rows in set, 1 warning (0.00 sec)
====================================================================================
* SQL
SELECT COUNT(사원번호) as 카운트
  FROM 사원
 WHERE 성별 = 'M'
   AND 사원번호 > 300000;

* 결과
+--------+
| 카운트 |
+--------+
|  60108 |
+--------+
1 row in set (0.05 sec)

====================================================================================
* SQL
EXPLAIN
SELECT COUNT(사원번호) as 카운트
  FROM 사원
 WHERE 성별 = 'M'
   AND 사원번호 > 300000;
   
* 결과
+----+-------------+-------+------------+-------+-------------------+-----------+---------+------+-------+----------+----------------------------------------+
| id | select_type | table | partitions | type  | possible_keys     | key       | key_len | ref  | rows  | filtered | Extra                                  |
+----+-------------+-------+------------+-------+-------------------+-----------+---------+------+-------+----------+----------------------------------------+
|  1 | SIMPLE      | 사원  | NULL       | range | PRIMARY,I_성별_성 | I_성별_성 | 55      | NULL | 49854 |   100.00 | Using where; Using index for skip scan |
+----+-------------+-------+------------+-------+-------------------+-----------+---------+------+-------+----------+----------------------------------------+
1 row in set, 1 warning (0.00 sec) 
====================================================================================
== 5.1.4. ==========================================================================
====================================================================================
* SQL
SELECT DISTINCT 매핑.부서번호
  FROM 부서관리자 관리자,
       부서사원_매핑 매핑
 WHERE 관리자.부서번호 = 매핑.부서번호
 ORDER BY 매핑.부서번호;

* 결과
+----------+
| 부서번호 |
+----------+
| d001     |
| d002     |
| d003     |
| d004     |
| d005     |
| d006     |
| d007     |
| d008     |
| d009     |
+----------+
9 rows in set (1.17 sec)

====================================================================================
* SQL
EXPLAIN
SELECT DISTINCT 매핑.부서번호
  FROM 부서관리자 관리자,
       부서사원_매핑 매핑
 WHERE 관리자.부서번호 = 매핑.부서번호
 ORDER BY 매핑.부서번호;
 
* 결과
+----+-------------+--------+------------+-------+--------------------+------------+---------+----------------------+--------+----------+------------------------------+
| id | select_type | table  | partitions | type  | possible_keys      | key        | key_len | ref                  | rows   | filtered | Extra                        |
+----+-------------+--------+------------+-------+--------------------+------------+---------+----------------------+--------+----------+------------------------------+
|  1 | SIMPLE      | 매핑   | NULL       | index | PRIMARY,I_부서번호 | I_부서번호 | 12      | NULL                 | 331143 |   100.00 | Using index; Using temporary |
|  1 | SIMPLE      | 관리자 | NULL       | ref   | I_부서번호         | I_부서번호 | 12      | tuning.매핑.부서번호 |      2 |   100.00 | Using index; Distinct        |
+----+-------------+--------+------------+-------+--------------------+------------+---------+----------------------+--------+----------+------------------------------+
2 rows in set, 1 warning (0.00 sec)
====================================================================================
* SQL
SELECT 매핑.부서번호
  FROM ( SELECT DISTINCT 부서번호 
           FROM 부서사원_매핑 매핑
       ) 매핑
 WHERE EXISTS (SELECT 1 
                 FROM 부서관리자 관리자
                WHERE 부서번호 = 매핑.부서번호)
 ORDER BY 매핑.부서번호;

* 결과
+----------+
| 부서번호 |
+----------+
| d001     |
| d002     |
| d003     |
| d004     |
| d005     |
| d006     |
| d007     |
| d008     |
| d009     |
+----------+
9 rows in set (0.00 sec)

====================================================================================
* SQL
EXPLAIN
SELECT 매핑.부서번호
  FROM ( SELECT DISTINCT 부서번호 
           FROM 부서사원_매핑 매핑
       ) 매핑
 WHERE EXISTS (SELECT 1 
                 FROM 부서관리자 관리자
                WHERE 부서번호 = 매핑.부서번호)
 ORDER BY 매핑.부서번호;
 
* 결과
+----+-------------+------------+------------+-------+--------------------+-------------+---------+------------------------+------+----------+---------------------------------------------------------+
| id | select_type | table      | partitions | type  | possible_keys      | key         | key_len | ref                    | rows | filtered | Extra                                                   |
+----+-------------+------------+------------+-------+--------------------+-------------+---------+------------------------+------+----------+---------------------------------------------------------+
|  1 | PRIMARY     | 관리자     | NULL       | index | I_부서번호         | I_부서번호  | 12      | NULL                   |   24 |    37.50 | Using index; Using temporary; Using filesort; LooseScan |
|  1 | PRIMARY     | <derived2> | NULL       | ref   | <auto_key0>        | <auto_key0> | 12      | tuning.관리자.부서번호 |    2 |   100.00 | Using index                                             |
|  2 | DERIVED     | 매핑       | NULL       | range | PRIMARY,I_부서번호 | I_부서번호  | 12      | NULL                   |    9 |   100.00 | Using index for group-by                                |
+----+-------------+------------+------------+-------+--------------------+-------------+---------+------------------------+------+----------+---------------------------------------------------------+
3 rows in set, 2 warnings (0.00 sec) 

====================================================================================
== 5.2.1. ==========================================================================
====================================================================================
* SQL
SELECT *
  FROM 사원
 WHERE 이름 = 'Georgi'
   AND 성 = 'Wielonsky';

* 결과
+----------+------------+--------+-----------+------+------------+
| 사원번호 | 생년월일   | 이름   | 성        | 성별 | 입사일자   |
+----------+------------+--------+-----------+------+------------+
|   499814 | 1960-12-28 | Georgi | Wielonsky | M    | 1989-01-31 |
+----------+------------+--------+-----------+------+------------+
1 row in set (0.19 sec)
====================================================================================
* SQL
EXPLAIN
SELECT *
  FROM 사원
 WHERE 이름 = 'Georgi'
   AND 성 = 'Wielonsky';
   
* 결과
+----+-------------+-------+------------+------+---------------+------+---------+------+--------+----------+-------------+
| id | select_type | table | partitions | type | possible_keys | key  | key_len | ref  | rows   | filtered | Extra       |
+----+-------------+-------+------------+------+---------------+------+---------+------+--------+----------+-------------+
|  1 | SIMPLE      | 사원  | NULL       | ALL  | NULL          | NULL | NULL    | NULL | 299157 |     1.00 | Using where |
+----+-------------+-------+------------+------+---------------+------+---------+------+--------+----------+-------------+
1 row in set, 1 warning (0.00 sec)
====================================================================================
* SQL
SELECT COUNT(DISTINCT(이름)) 이름_개수, COUNT(DISTINCT(성  )) 성_개수, COUNT(1) 전체
FROM 사원;

* 결과
+-----------+---------+--------+
| 이름_개수 | 성_개수 | 전체   |
+-----------+---------+--------+
|      1275 |    1637 | 300024 |
+-----------+---------+--------+
1 row in set (0.41 sec)
====================================================================================
* SQL
ALTER TABLE 사원
ADD INDEX I_사원_성_이름 (성,이름);

* 결과
Query OK, 0 rows affected (1.94 sec)
====================================================================================
* SQL
show index from 사원;

* 결과
+-------+------------+------------+--------------+-------------+-----------+-------------+----------+--------+------+------------+---------+---------------+---------+------------+
| Table | Non_unique | Key_name   | Seq_in_index | Column_name | Collation | Cardinality | Sub_part | Packed | Null | Index_type | Comment | Index_comment | Visible | Expression |
+-------+------------+------------+--------------+-------------+-----------+-------------+----------+--------+------+------------+---------+---------------+---------+------------+
| 사원  |          0 | PRIMARY    |            1 | 사원번호    | A         |      299157 |     NULL |   NULL |      | BTREE      |         |               | YES     | NULL       |
| 사원  |          1 | I_입사일자 |            1 | 입사일자    | A         |        4612 |     NULL |   NULL |      | BTREE      |         |               | YES     | NULL       |
| 사원  |          1 | I_성별_성  |            1 | 성별        | A         |           1 |     NULL |   NULL |      | BTREE      |         |               | YES     | NULL       |
| 사원  |          1 | I_성별_성  |            2 | 성          | A         |        3257 |     NULL |   NULL |      | BTREE      |         |               | YES     | NULL       |
+-------+------------+------------+--------------+-------------+-----------+-------------+----------+--------+------+------------+---------+---------------+---------+------------+
4 rows in set (0.00 sec)
====================================================================================
* SQL
SELECT *
FROM 사원
WHERE 이름 = 'Georgi'
AND 성 = 'Wielonsky';

* 결과
+----------+------------+--------+-----------+------+------------+
| 사원번호 | 생년월일   | 이름   | 성        | 성별 | 입사일자   |
+----------+------------+--------+-----------+------+------------+
|   499814 | 1960-12-28 | Georgi | Wielonsky | M    | 1989-01-31 |
+----------+------------+--------+-----------+------+------------+
1 row in set (0.00 sec)

====================================================================================
* SQL
EXPLAIN
SELECT *
FROM 사원
WHERE 이름 = 'Georgi'
AND 성 = 'Wielonsky';

* 결과
+----+-------------+-------+------------+------+----------------+----------------+---------+-------------+------+----------+-------+
| id | select_type | table | partitions | type | possible_keys  | key            | key_len | ref         | rows | filtered | Extra |
+----+-------------+-------+------------+------+----------------+----------------+---------+-------------+------+----------+-------+
|  1 | SIMPLE      | 사원  | NULL       | ref  | I_사원_성_이름 | I_사원_성_이름 | 94      | const,const |    1 |   100.00 | NULL  |
+----+-------------+-------+------------+------+----------------+----------------+---------+-------------+------+----------+-------+
1 row in set, 1 warning (0.00 sec)
====================================================================================
* SQL
alter table 사원 drop index I_사원_성_이름;

* 결과
Query OK, 0 rows affected (0.01 sec)
Records: 0  Duplicates: 0  Warnings: 0

====================================================================================
== 5.2.2. ==========================================================================
====================================================================================
* SQL
SELECT *
  FROM 사원
 WHERE 이름 = 'Matt'
    OR 입사일자 = '1987-03-31';

* 결과
+----------+------------+-------------+-----------------+------+------------+
| 사원번호 | 생년월일   | 이름        | 성              | 성별 | 입사일자   |
+----------+------------+-------------+-----------------+------+------------+
|    10083 | 1959-07-23 | Vishv       | Zockler         | M    | 1987-03-31 |
|    10690 | 1962-09-06 | Matt        | Jumpertz        | F    | 1989-08-22 |
|    12302 | 1962-02-14 | Matt        | Plessier        | M    | 1987-01-28 |
... 중략 ...
|   495781 | 1960-10-06 | Georg       | Velasco         | M    | 1987-03-31 |
|   497243 | 1962-10-13 | Jianwen     | Kalsbeek        | M    | 1987-03-31 |
|   497766 | 1960-09-25 | Matt        | Atrawala        | F    | 1987-02-11 |
+----------+------------+-------------+-----------------+------+------------+
343 rows in set (0.24 sec)
====================================================================================
* SQL
EXPLAIN
SELECT *
  FROM 사원
 WHERE 이름 = 'Matt'
    OR 입사일자 = '1987-03-31';
	
* 결과
+----+-------------+-------+------------+------+---------------+------+---------+------+--------+----------+-------------+
| id | select_type | table | partitions | type | possible_keys | key  | key_len | ref  | rows   | filtered | Extra       |
+----+-------------+-------+------------+------+---------------+------+---------+------+--------+----------+-------------+
|  1 | SIMPLE      | 사원  | NULL       | ALL  | I_입사일자    | NULL | NULL    | NULL | 299157 |    10.02 | Using where |
+----+-------------+-------+------------+------+---------------+------+---------+------+--------+----------+-------------+
1 row in set, 1 warning (0.00 sec)
====================================================================================
* SQL
select count(1) from 사원;

* 결과
+----------+
| count(1) |
+----------+
|   300024 |
+----------+
1 row in set (2.37 sec)

====================================================================================
* SQL
select count(1) from 사원 where 이름='Matt';

* 결과
+----------+
| count(1) |
+----------+
|      233 |
+----------+
1 row in set (0.16 sec)

====================================================================================

* SQL
select count(1) from 사원 where 입사일자='1987-03-31';

* 결과
+----------+
| count(1) |
+----------+
|      111 |
+----------+
1 row in set (0.00 sec)

====================================================================================
* SQL
show index from 사원;

* 결과
+-------+------------+------------+--------------+-------------+-----------+-------------+----------+--------+------+------------+---------+---------------+---------+------------+
| Table | Non_unique | Key_name   | Seq_in_index | Column_name | Collation | Cardinality | Sub_part | Packed | Null | Index_type | Comment | Index_comment | Visible | Expression |
+-------+------------+------------+--------------+-------------+-----------+-------------+----------+--------+------+------------+---------+---------------+---------+------------+
| 사원  |          0 | PRIMARY    |            1 | 사원번호    | A         |      299157 |     NULL |   NULL |      | BTREE      |         |               | YES     | NULL       |
| 사원  |          1 | I_입사일자 |            1 | 입사일자    | A         |        4612 |     NULL |   NULL |      | BTREE      |         |               | YES     | NULL       |
| 사원  |          1 | I_성별_성  |            1 | 성별        | A         |           1 |     NULL |   NULL |      | BTREE      |         |               | YES     | NULL       |
| 사원  |          1 | I_성별_성  |            2 | 성          | A         |        3257 |     NULL |   NULL |      | BTREE      |         |               | YES     | NULL       |
+-------+------------+------------+--------------+-------------+-----------+-------------+----------+--------+------+------------+---------+---------------+---------+------------+
4 rows in set (0.00 sec)

====================================================================================
* SQL
ALTER TABLE 사원
ADD INDEX I_이름(이름);

* 결과
Query OK, 0 rows affected (1.16 sec)
Records: 0  Duplicates: 0  Warnings: 0

====================================================================================
* SQL
SELECT *
  FROM 사원
 WHERE 이름 = 'Matt'
    OR 입사일자 = '1987-03-31';

* 결과
+----------+------------+-------------+-----------------+------+------------+
| 사원번호 | 생년월일   | 이름        | 성              | 성별 | 입사일자   |
+----------+------------+-------------+-----------------+------+------------+
|    10083 | 1959-07-23 | Vishv       | Zockler         | M    | 1987-03-31 |
|    10690 | 1962-09-06 | Matt        | Jumpertz        | F    | 1989-08-22 |
|    12302 | 1962-02-14 | Matt        | Plessier        | M    | 1987-01-28 |
... 중략 ...
|   495781 | 1960-10-06 | Georg       | Velasco         | M    | 1987-03-31 |
|   497243 | 1962-10-13 | Jianwen     | Kalsbeek        | M    | 1987-03-31 |
|   497766 | 1960-09-25 | Matt        | Atrawala        | F    | 1987-02-11 |
+----------+------------+-------------+-----------------+------+------------+
343 rows in set (0.00 sec)

====================================================================================
* SQL
EXPLAIN
SELECT *
  FROM 사원
 WHERE 이름 = 'Matt'
    OR 입사일자 = '1987-03-31';
	
* 결과
+----+-------------+-------+------------+-------------+-------------------+-------------------+---------+------+------+----------+---------------------------------------------+
| id | select_type | table | partitions | type        | possible_keys     | key               | key_len | ref  | rows | filtered | Extra                                       |
+----+-------------+-------+------------+-------------+-------------------+-------------------+---------+------+------+----------+---------------------------------------------+
|  1 | SIMPLE      | 사원  | NULL       | index_merge | I_입사일자,I_이름 | I_이름,I_입사일자 | 44,3    | NULL |  344 |   100.00 | Using union(I_이름,I_입사일자); Using where |
+----+-------------+-------+------------+-------------+-------------------+-------------------+---------+------+------+----------+---------------------------------------------+
1 row in set, 1 warning (0.00 sec)
====================================================================================
* SQL
ALTER TABLE 사원
DROP INDEX I_이름;

* 결과
Query OK, 0 rows affected (0.02 sec)
Records: 0  Duplicates: 0  Warnings: 0

====================================================================================
== 5.2.3. ==========================================================================
====================================================================================
* SQL
select @@autocommit;

* 결과
+--------------+
| @@autocommit |
+--------------+
|            1 |
+--------------+
1 row in set (0.00 sec)

====================================================================================
* SQL
set autocommit=0;

* 결과
Query OK, 0 rows affected (0.00 sec)

====================================================================================
* SQL
select @@autocommit;

* 결과
+--------------+
| @@autocommit |
+--------------+
|            0 |
+--------------+
1 row in set (0.00 sec)

====================================================================================
* SQL
UPDATE 사원출입기록
SET 출입문 = 'X'
WHERE 출입문 = 'B';

* 결과	
Query OK, 300000 rows affected (34.13 sec)
Rows matched: 300000  Changed: 300000  Warnings: 0

====================================================================================
* SQL
rollback;

* 결과
Query OK, 0 rows affected (17.52 sec)

====================================================================================
* SQL
EXPLAIN
UPDATE 사원출입기록
SET 출입문 = 'X'
WHERE 출입문 = 'B';

* 결과
+----+-------------+--------------+------------+-------+---------------+---------+---------+------+--------+----------+-------------+
| id | select_type | table        | partitions | type  | possible_keys | key     | key_len | ref  | rows   | filtered | Extra       |
+----+-------------+--------------+------------+-------+---------------+---------+---------+------+--------+----------+-------------+
|  1 | UPDATE      | 사원출입기록 | NULL       | index | I_출입문      | PRIMARY | 8       | NULL | 658935 |   100.00 | Using where |
+----+-------------+--------------+------------+-------+---------------+---------+---------+------+--------+----------+-------------+
1 row in set, 1 warning (0.02 sec)
====================================================================================
* SQL
show index from 사원출입기록;

* 결과
+--------------+------------+----------+--------------+-------------+-----------+-------------+----------+--------+------+------------+---------+---------------+---------+------------+
| Table        | Non_unique | Key_name | Seq_in_index | Column_name | Collation | Cardinality | Sub_part | Packed | Null | Index_type | Comment | Index_comment | Visible | Expression |
+--------------+------------+----------+--------------+-------------+-----------+-------------+----------+--------+------+------------+---------+---------------+---------+------------+
| 사원출입기록 |          0 | PRIMARY  |            1 | 순번        | A         |      658935 |     NULL |   NULL |      | BTREE      |         |               | YES     | NULL       |
| 사원출입기록 |          0 | PRIMARY  |            2 | 사원번호    | A         |      658935 |     NULL |   NULL |      | BTREE      |         |               | YES     | NULL       |
| 사원출입기록 |          1 | I_지역   |            1 | 지역        | A         |           4 |     NULL |   NULL | YES  | BTREE      |         |               | YES     | NULL       |
| 사원출입기록 |          1 | I_시간   |            1 | 입출입시간  | A         |      652638 |     NULL |   NULL |      | BTREE      |         |               | YES     | NULL       |
| 사원출입기록 |          1 | I_출입문 |            1 | 출입문      | A         |           3 |     NULL |   NULL | YES  | BTREE      |         |               | YES     | NULL       |
+--------------+------------+----------+--------------+-------------+-----------+-------------+----------+--------+------+------------+---------+---------------+---------+------------+
5 rows in set (0.00 sec)
====================================================================================
* SQL
ALTER TABLE 사원출입기록
DROP INDEX I_출입문;

* 결과
Query OK, 0 rows affected (0.03 sec)
Records: 0  Duplicates: 0  Warnings: 0

====================================================================================
* SQL
show index from 사원출입기록;

* 결과
+--------------+------------+----------+--------------+-------------+-----------+-------------+----------+--------+------+------------+---------+---------------+---------+------------+
| Table        | Non_unique | Key_name | Seq_in_index | Column_name | Collation | Cardinality | Sub_part | Packed | Null | Index_type | Comment | Index_comment | Visible | Expression |
+--------------+------------+----------+--------------+-------------+-----------+-------------+----------+--------+------+------------+---------+---------------+---------+------------+
| 사원출입기록 |          0 | PRIMARY  |            1 | 순번        | A         |      658935 |     NULL |   NULL |      | BTREE      |         |               | YES     | NULL       |
| 사원출입기록 |          0 | PRIMARY  |            2 | 사원번호    | A         |      658935 |     NULL |   NULL |      | BTREE      |         |               | YES     | NULL       |
| 사원출입기록 |          1 | I_지역   |            1 | 지역        | A         |           4 |     NULL |   NULL | YES  | BTREE      |         |               | YES     | NULL       |
| 사원출입기록 |          1 | I_시간   |            1 | 입출입시간  | A         |      652638 |     NULL |   NULL |      | BTREE      |         |               | YES     | NULL       |
+--------------+------------+----------+--------------+-------------+-----------+-------------+----------+--------+------+------------+---------+---------------+---------+------------+
4 rows in set (0.00 sec)

====================================================================================
* SQL
SELECT @@autocommit;

* 결과
+--------------+
| @@autocommit |
+--------------+
|            0 |
+--------------+
1 row in set (0.00 sec)
====================================================================================
* SQL
UPDATE 사원출입기록
SET 출입문 = 'X'
WHERE 출입문 = 'B';

* 결과
Query OK, 300000 rows affected (3.82 sec)
Rows matched: 300000  Changed: 300000  Warnings: 0

====================================================================================
* SQL
rollback;

* 결과
Query OK, 0 rows affected (4.08 sec)

====================================================================================
* SQL
EXPLAIN
UPDATE 사원출입기록
SET 출입문 = 'X'
WHERE 출입문 = 'B';

* 결과
+----+-------------+--------------+------------+-------+---------------+---------+---------+------+--------+----------+-------------+
| id | select_type | table        | partitions | type  | possible_keys | key     | key_len | ref  | rows   | filtered | Extra       |
+----+-------------+--------------+------------+-------+---------------+---------+---------+------+--------+----------+-------------+
|  1 | UPDATE      | 사원출입기록 | NULL       | index | I_출입문      | PRIMARY | 8       | NULL | 658935 |   100.00 | Using where |
+----+-------------+--------------+------------+-------+---------------+---------+---------+------+--------+----------+-------------+
1 row in set, 1 warning (0.00 sec)
====================================================================================
* SQL
ALTER TABLE 사원출입기록
ADD INDEX I_출입문(출입문);

* 결과
Query OK, 0 rows affected (1.94 sec)
Records: 0  Duplicates: 0  Warnings: 0

====================================================================================

* SQL
set autocommit=1;

* 결과
Query OK, 0 rows affected (0.00 sec)

====================================================================================

* SQL
select @@autocommit;

* 결과
+--------------+
| @@autocommit |
+--------------+
|            1 |
+--------------+
1 row in set (0.00 sec)

====================================================================================
== 5.2.4. ==========================================================================
====================================================================================
* SQL
SELECT 사원번호, 이름, 성
  FROM 사원
 WHERE 성별 = 'M'
   AND 성 = 'Baba';

* 결과
+----------+----------------+------+
| 사원번호 | 이름           | 성   |
+----------+----------------+------+
|    11937 | Zissis         | Baba |
|    12245 | Christ         | Baba |
|    15596 | Bedir          | Baba |
... 중략 ...
|   492391 | Alenka         | Baba |
|   494271 | Zsolt          | Baba |
|   499900 | Leon           | Baba |
+----------+----------------+------+
135 rows in set (0.04 sec)

====================================================================================
* SQL
EXPLAIN
SELECT 사원번호, 이름, 성
  FROM 사원
 WHERE 성별 = 'M'
   AND 성 = 'Baba';

* 결과
+----+-------------+-------+------------+------+---------------+-----------+---------+-------------+------+----------+-------+
| id | select_type | table | partitions | type | possible_keys | key       | key_len | ref         | rows | filtered | Extra |
+----+-------------+-------+------------+------+---------------+-----------+---------+-------------+------+----------+-------+
|  1 | SIMPLE      | 사원  | NULL       | ref  | I_성별_성     | I_성별_성 | 51      | const,const |  135 |   100.00 | NULL  |
+----+-------------+-------+------------+------+---------------+-----------+---------+-------------+------+----------+-------+
1 row in set, 1 warning (0.00 sec)
====================================================================================
* SQL
SELECT COUNT(DISTINCT 성) 성_개수, COUNT(DISTINCT 성별) 성별_개수  
FROM 사원 ;

* 결과
+---------+-----------+
| 성_개수 | 성별_개수 |
+---------+-----------+
|    1637 |         2 |
+---------+-----------+
1 row in set (0.23 sec)
====================================================================================
* SQL
show index from 사원;

* 결과
+-------+------------+------------+--------------+-------------+-----------+-------------+----------+--------+------+------------+---------+---------------+---------+------------+
| Table | Non_unique | Key_name   | Seq_in_index | Column_name | Collation | Cardinality | Sub_part | Packed | Null | Index_type | Comment | Index_comment | Visible | Expression |
+-------+------------+------------+--------------+-------------+-----------+-------------+----------+--------+------+------------+---------+---------------+---------+------------+
| 사원  |          0 | PRIMARY    |            1 | 사원번호    | A         |      299157 |     NULL |   NULL |      | BTREE      |         |               | YES     | NULL       |
| 사원  |          1 | I_입사일자 |            1 | 입사일자    | A         |        4612 |     NULL |   NULL |      | BTREE      |         |               | YES     | NULL       |
| 사원  |          1 | I_성별_성  |            1 | 성별        | A         |           1 |     NULL |   NULL |      | BTREE      |         |               | YES     | NULL       |
| 사원  |          1 | I_성별_성  |            2 | 성          | A         |        3257 |     NULL |   NULL |      | BTREE      |         |               | YES     | NULL       |
+-------+------------+------------+--------------+-------------+-----------+-------------+----------+--------+------+------------+---------+---------------+---------+------------+
4 rows in set (0.00 sec)
====================================================================================
* SQL
ALTER TABLE 사원
DROP INDEX I_성별_성,
ADD INDEX I_성_성별(성, 성별);

* 결과
Query OK, 0 rows affected (2.02 sec)
Records: 0  Duplicates: 0  Warnings: 0

====================================================================================
* SQL
SELECT 사원번호, 이름, 성
FROM 사원
WHERE 성별 = 'M'
AND 성 = 'Baba';

* 결과
+----------+----------------+------+
| 사원번호 | 이름           | 성   |
+----------+----------------+------+
|    11937 | Zissis         | Baba |
|    12245 | Christ         | Baba |
|    15596 | Bedir          | Baba |
... 중략 ...
|   492391 | Alenka         | Baba |
|   494271 | Zsolt          | Baba |
|   499900 | Leon           | Baba |
+----------+----------------+------+
135 rows in set (0.00 sec)
====================================================================================
* SQL
EXPLAIN
SELECT 사원번호, 이름, 성
FROM 사원
WHERE 성별 = 'M'
AND 성 = 'Baba';

* 결과
+----+-------------+-------+------------+------+---------------+-----------+---------+-------------+------+----------+-------+
| id | select_type | table | partitions | type | possible_keys | key       | key_len | ref         | rows | filtered | Extra |
+----+-------------+-------+------------+------+---------------+-----------+---------+-------------+------+----------+-------+
|  1 | SIMPLE      | 사원  | NULL       | ref  | I_성_성별     | I_성_성별 | 51      | const,const |  135 |   100.00 | NULL  |
+----+-------------+-------+------------+------+---------------+-----------+---------+-------------+------+----------+-------+
1 row in set, 1 warning (0.00 sec)
====================================================================================
* SQL
ALTER TABLE 사원
DROP INDEX I_성_성별,
ADD INDEX I_성별_성(성별, 성);

* 결과
Query OK, 0 rows affected (1.37 sec)
Records: 0  Duplicates: 0  Warnings: 0

====================================================================================
== 5.3.1. ==========================================================================
====================================================================================
* SQL
SELECT 부서명, 비고
  FROM 부서
 WHERE 비고 = 'active'
   AND ASCII(SUBSTR(비고,1,1)) = 97
   AND ASCII(SUBSTR(비고,2,1)) = 99;

* 결과
+------------------+--------+
| 부서명           | 비고   |
+------------------+--------+
| Human Resources  | active |
| Production       | active |
| Sales            | active |
| Customer Service | active |
+------------------+--------+
4 rows in set (0.00 sec)

====================================================================================
* SQL
SELECT 부서명, 비고
FROM 부서
WHERE 비고 = 'active';

* 결과
+------------------+--------+
| 부서명           | 비고   |
+------------------+--------+
| Marketing        | aCTIVE |
| Finance          | ACTIVE |
| Human Resources  | active |
| Production       | active |
| Development      | Active |
| Sales            | active |
| Customer Service | active |
+------------------+--------+
7 rows in set (0.00 sec)
====================================================================================
* SQL
SELECT 비고, 
       SUBSTR(비고,1,1) 첫번째, 
       ASCII(SUBSTR(비고,1,1)) 첫번째_아스키, 
	   SUBSTR(비고,2,1) 두번째,
       ASCII(SUBSTR(비고,2,1)) 두번째_아스키
FROM 부서
WHERE 비고 = 'active';

* 결과
+--------+--------+---------------+--------+---------------+
| 비고   | 첫번째 | 첫번째_아스키 | 두번째 | 두번째_아스키 |
+--------+--------+---------------+--------+---------------+
| aCTIVE | a      |            97 | C      |            67 |
| ACTIVE | A      |            65 | C      |            67 |
| active | a      |            97 | c      |            99 |
| active | a      |            97 | c      |            99 |
| Active | A      |            65 | c      |            99 |
| active | a      |            97 | c      |            99 |
| active | a      |            97 | c      |            99 |
+--------+--------+---------------+--------+---------------+
7 rows in set (0.00 sec)
====================================================================================
* SQL
SELECT COLUMN_NAME, collation_name
FROM information_schema.COLUMNS
WHERE table_schema = 'tuning'
AND TABLE_NAME = '부서';

* 결과
+-------------+-----------------+
| COLUMN_NAME | COLLATION_NAME  |
+-------------+-----------------+
| 부서번호    | utf8_general_ci |
| 부서명      | utf8_general_ci |
| 비고        | utf8_general_ci |
+-------------+-----------------+
3 rows in set (0.01 sec)
====================================================================================
* SQL
ALTER TABLE 부서
CHANGE COLUMN 비고 비고 VARCHAR(40) NULL DEFAULT NULL COLLATE 'UTF8MB4_bin';

* 결과
Query OK, 0 rows affected (0.01 sec)
Records: 0  Duplicates: 0  Warnings: 0

====================================================================================
* SQL
SELECT COLUMN_NAME, collation_name
FROM information_schema.COLUMNS
WHERE table_schema = 'tuning'
AND TABLE_NAME = '부서';

* 결과
+-------------+-----------------+
| COLUMN_NAME | COLLATION_NAME  |
+-------------+-----------------+
| 부서번호    | utf8_general_ci |
| 부서명      | utf8_general_ci |
| 비고        | utf8mb4_bin     |
+-------------+-----------------+
3 rows in set (0.01 sec)

====================================================================================
* SQL
SELECT 부서명, 비고
FROM 부서
WHERE 비고 = 'active';

* 결과
+------------------+--------+
| 부서명           | 비고   |
+------------------+--------+
| Human Resources  | active |
| Production       | active |
| Sales            | active |
| Customer Service | active |
+------------------+--------+
4 rows in set (0.00 sec)

====================================================================================
* SQL
ALTER TABLE 부서
CHANGE COLUMN 비고 비고 VARCHAR(40) NULL DEFAULT NULL COLLATE 'utf8_general_ci';

* 결과
Query OK, 9 rows affected, 1 warning (0.05 sec)
Records: 9  Duplicates: 0  Warnings: 1

====================================================================================
== 5.3.2. ==========================================================================
====================================================================================
* SQL
SELECT 이름, 성, 성별, 생년월일
FROM 사원
WHERE LOWER(이름) = LOWER('MARY')
AND 입사일자 >= STR_TO_DATE('1990-01-01', '%Y-%m-%d');

* 결과
+------+----------------+------+------------+
| 이름 | 성             | 성별 | 생년월일   |
+------+----------------+------+------------+
| Mary | Sluis          | F    | 1953-11-07 |
| Mary | Piazza         | F    | 1954-10-18 |
| Mary | Ertl           | F    | 1962-03-08 |
| Mary | Monarch        | F    | 1956-08-14 |
| Mary | DasSarma       | F    | 1955-05-23 |
| Mary | Ananiadou      | F    | 1964-06-04 |
| Mary | Ritcey         | M    | 1955-12-28 |
| Mary | Schapire       | M    | 1956-04-29 |
| Mary | Demian         | M    | 1961-11-05 |
| Mary | Lanzelotte     | M    | 1954-06-16 |
| Mary | Fujisawa       | F    | 1959-03-27 |
| Mary | Monarch        | F    | 1955-10-27 |
| Mary | Srimani        | M    | 1961-03-13 |
| Mary | Itzfeldt       | F    | 1953-11-06 |
| Mary | Babu           | F    | 1963-08-31 |
| Mary | Glinert        | F    | 1959-02-14 |
| Mary | Hofmeyr        | F    | 1952-10-06 |
| Mary | Milicic        | M    | 1963-12-13 |
| Mary | Hiroyama       | M    | 1952-11-29 |
| Mary | Lindenbaum     | F    | 1964-01-01 |
| Mary | Kalafatis      | F    | 1953-02-15 |
| Mary | Perz           | F    | 1955-07-25 |
| Mary | Nishimukai     | M    | 1960-11-01 |
| Mary | Ananiadou      | M    | 1963-10-06 |
| Mary | Holburn        | M    | 1955-01-22 |
| Mary | Pelz           | M    | 1954-12-17 |
| Mary | Hammerschmidt  | M    | 1952-05-19 |
| Mary | Gruenwald      | M    | 1957-01-14 |
| Mary | Siochi         | M    | 1962-10-05 |
| Mary | Kalefeld       | F    | 1960-07-02 |
| Mary | Chimia         | M    | 1952-02-03 |
| Mary | Ghalwash       | M    | 1963-09-11 |
| Mary | Puoti          | F    | 1954-05-04 |
| Mary | Ulupinar       | M    | 1959-03-30 |
| Mary | Gente          | F    | 1958-02-18 |
| Mary | Hasenauer      | M    | 1952-10-17 |
| Mary | Mitsuhashi     | M    | 1957-03-06 |
| Mary | Billingsley    | F    | 1955-12-01 |
| Mary | Hofman         | M    | 1962-08-11 |
| Mary | Lorch          | F    | 1957-01-28 |
| Mary | Danecki        | M    | 1952-02-10 |
| Mary | Molenkamp      | M    | 1955-10-10 |
| Mary | DasSarma       | M    | 1958-12-18 |
| Mary | Thiria         | M    | 1962-05-13 |
| Mary | Axelband       | M    | 1956-10-26 |
| Mary | Uhrik          | M    | 1955-12-02 |
| Mary | Bugaenko       | M    | 1955-08-19 |
| Mary | Shihab         | M    | 1963-01-29 |
| Mary | Yoshizawa      | M    | 1955-05-11 |
| Mary | Krichel        | M    | 1952-06-24 |
| Mary | Peha           | M    | 1962-03-09 |
| Mary | Czaja          | F    | 1955-06-29 |
| Mary | Katalagarianos | M    | 1960-07-01 |
| Mary | Heyers         | M    | 1952-05-27 |
| Mary | Schlegelmilch  | M    | 1953-02-24 |
| Mary | Wuwongse       | M    | 1964-08-09 |
| Mary | Servieres      | M    | 1963-03-24 |
| Mary | Perna          | F    | 1954-12-07 |
| Mary | Busillo        | M    | 1963-03-26 |
| Mary | Cronau         | F    | 1957-02-09 |
| Mary | Comellas       | M    | 1959-01-07 |
| Mary | Braunschweig   | M    | 1955-05-29 |
| Mary | Kampfer        | F    | 1956-03-10 |
| Mary | Carrere        | F    | 1964-06-07 |
| Mary | Ratnaker       | M    | 1953-10-19 |
| Mary | Gils           | M    | 1953-08-29 |
| Mary | Mitchem        | M    | 1953-03-03 |
| Mary | Pietrzykowski  | M    | 1961-10-06 |
| Mary | Tokunaga       | F    | 1960-06-24 |
| Mary | Stavenow       | F    | 1964-03-23 |
| Mary | Burnard        | F    | 1953-03-20 |
| Mary | Lamparter      | F    | 1953-02-27 |
| Mary | Speek          | M    | 1953-12-04 |
| Mary | Edelhoff       | M    | 1952-03-12 |
| Mary | Assaf          | F    | 1953-11-02 |
| Mary | Casley         | M    | 1961-08-28 |
| Mary | Bahk           | F    | 1952-08-29 |
| Mary | Schrooten      | M    | 1957-08-30 |
| Mary | Kornyak        | F    | 1957-10-03 |
| Mary | Jansen         | M    | 1961-03-26 |
| Mary | Weedman        | M    | 1959-07-15 |
| Mary | Cronin         | F    | 1953-11-17 |
| Mary | Kampfer        | M    | 1957-06-16 |
| Mary | Mitsuhashi     | M    | 1962-01-20 |
| Mary | Conti          | M    | 1962-02-27 |
| Mary | Staudhammer    | M    | 1960-08-06 |
| Mary | Keohane        | M    | 1952-12-29 |
| Mary | Kumaresan      | M    | 1958-02-24 |
| Mary | Mahmud         | M    | 1960-07-03 |
| Mary | Facello        | M    | 1953-10-11 |
| Mary | Birrer         | M    | 1964-05-16 |
| Mary | Nyanchama      | M    | 1956-05-15 |
| Mary | Baba           | F    | 1958-06-25 |
| Mary | Swift          | M    | 1957-05-29 |
| Mary | Showalter      | M    | 1953-01-05 |
| Mary | Tiemann        | M    | 1954-10-05 |
+------+----------------+------+------------+
96 rows in set (0.18 sec)
====================================================================================
* SQL
EXPLAIN
SELECT 이름, 성, 성별, 생년월일
FROM 사원
WHERE LOWER(이름) = LOWER('MARY')
AND 입사일자 >= STR_TO_DATE('1990-01-01', '%Y-%m-%d');

* 결과
+----+-------------+-------+------------+------+---------------+------+---------+------+--------+----------+-------------+
| id | select_type | table | partitions | type | possible_keys | key  | key_len | ref  | rows   | filtered | Extra       |
+----+-------------+-------+------------+------+---------------+------+---------+------+--------+----------+-------------+
|  1 | SIMPLE      | 사원  | NULL       | ALL  | I_입사일자    | NULL | NULL    | NULL | 299157 |    50.00 | Using where |
+----+-------------+-------+------------+------+---------------+------+---------+------+--------+----------+-------------+
1 row in set, 1 warning (0.01 sec)
====================================================================================
* SQL
SELECT COUNT(1)
FROM 사원;

* 결과
+----------+
| COUNT(1) |
+----------+
|   300024 |
+----------+
1 row in set (2.37 sec)
====================================================================================
* SQL
SELECT COUNT(1)
FROM 사원
WHERE 입사일자 >= STR_TO_DATE('1990-01-01', '%Y-%m-%d');

* 결과
+----------+
| COUNT(1) |
+----------+
|   135227 |
+----------+
1 row in set (0.04 sec)
====================================================================================
* SQL
SELECT COUNT(1)
FROM 사원
WHERE LOWER(이름) = LOWER('MARY');

* 결과
+----------+
| COUNT(1) |
+----------+
|      224 |
+----------+
1 row in set (0.09 sec)
====================================================================================
* SQL
show index from 사원;

* 결과
+-------+------------+------------+--------------+-------------+-----------+-------------+----------+--------+------+------------+---------+---------------+---------+------------+
| Table | Non_unique | Key_name   | Seq_in_index | Column_name | Collation | Cardinality | Sub_part | Packed | Null | Index_type | Comment | Index_comment | Visible | Expression |
+-------+------------+------------+--------------+-------------+-----------+-------------+----------+--------+------+------------+---------+---------------+---------+------------+
| 사원  |          0 | PRIMARY    |            1 | 사원번호    | A         |      299157 |     NULL |   NULL |      | BTREE      |         |               | YES     | NULL       |
| 사원  |          1 | I_입사일자 |            1 | 입사일자    | A         |        4612 |     NULL |   NULL |      | BTREE      |         |               | YES     | NULL       |
| 사원  |          1 | I_성별_성  |            1 | 성별        | A         |           1 |     NULL |   NULL |      | BTREE      |         |               | YES     | NULL       |
| 사원  |          1 | I_성별_성  |            2 | 성          | A         |        3257 |     NULL |   NULL |      | BTREE      |         |               | YES     | NULL       |
+-------+------------+------------+--------------+-------------+-----------+-------------+----------+--------+------+------------+---------+---------------+---------+------------+
4 rows in set (0.00 sec)
====================================================================================
* SQL
SELECT *
FROM 사원
WHERE 이름 = 'MARY';

* 결과
Empty set (0.32 sec)

====================================================================================
* SQL
SELECT COLUMN_NAME, collation_name
FROM information_schema.columns
WHERE TABLE_NAME='사원'
AND table_schema='tuning';

* 결과
+-------------+-----------------+
| COLUMN_NAME | COLLATION_NAME  |
+-------------+-----------------+
| 사원번호    | NULL            |
| 생년월일    | NULL            |
| 이름        | utf8_bin        |
| 성          | utf8_general_ci |
| 성별        | utf8_general_ci |
| 입사일자    | NULL            |
+-------------+-----------------+
6 rows in set (0.00 sec)

====================================================================================
* SQL
ALTER TABLE 사원 ADD COLUMN 소문자_이름 VARCHAR(14) NOT NULL AFTER 이름;
* 결과
Query OK, 0 rows affected (3.47 sec)
Records: 0  Duplicates: 0  Warnings: 0

====================================================================================

* SQL
UPDATE 사원
SET 소문자_이름 = LOWER(이름);

* 결과
Query OK, 300024 rows affected (13.96 sec)
Rows matched: 300024  Changed: 300024  Warnings: 0

====================================================================================

* SQL
ALTER TABLE 사원 ADD INDEX I_소문자이름(소문자_이름);

* 결과
Query OK, 0 rows affected (1.08 sec)
Records: 0  Duplicates: 0  Warnings: 0

====================================================================================
* SQL
desc 사원;

* 결과
+-------------+---------------+------+-----+---------+-------+
| Field       | Type          | Null | Key | Default | Extra |
+-------------+---------------+------+-----+---------+-------+
| 사원번호    | int           | NO   | PRI | NULL    |       |
| 생년월일    | date          | NO   |     | NULL    |       |
| 이름        | varchar(14)   | NO   |     | NULL    |       |
| 소문자_이름 | varchar(14)   | NO   | MUL | NULL    |       |
| 성          | varchar(16)   | NO   |     | NULL    |       |
| 성별        | enum('M','F') | NO   | MUL | NULL    |       |
| 입사일자    | date          | NO   | MUL | NULL    |       |
+-------------+---------------+------+-----+---------+-------+
7 rows in set (0.01 sec)

====================================================================================
* SQL
SELECT 이름, 소문자_이름
FROM 사원
LIMIT 10;

* 결과
+-----------+-------------+
| 이름      | 소문자_이름 |
+-----------+-------------+
| Georgi    | georgi      |
| Bezalel   | bezalel     |
| ParTo     | parto       |
| Chirstian | chirstian   |
| Kyoichi   | kyoichi     |
| AnneKe    | anneke      |
| Tzvetan   | tzvetan     |
| Saniya    | saniya      |
| Sumant    | sumant      |
| Duangkaew | duangkaew   |
+-----------+-------------+
10 rows in set (0.00 sec)

====================================================================================
* SQL
SELECT 이름, 성, 성별, 생년월일
FROM 사원
WHERE 소문자_이름= 'MARY'
AND 입사일자 >= '1990-01-01';

* 결과
+------+----------------+------+------------+
| 이름 | 성             | 성별 | 생년월일   |
+------+----------------+------+------------+
| Mary | Sluis          | F    | 1953-11-07 |
| Mary | Piazza         | F    | 1954-10-18 |
| Mary | Ertl           | F    | 1962-03-08 |
| Mary | Monarch        | F    | 1956-08-14 |
| Mary | DasSarma       | F    | 1955-05-23 |
| Mary | Ananiadou      | F    | 1964-06-04 |
| Mary | Ritcey         | M    | 1955-12-28 |
| Mary | Schapire       | M    | 1956-04-29 |
| Mary | Demian         | M    | 1961-11-05 |
| Mary | Lanzelotte     | M    | 1954-06-16 |
| Mary | Fujisawa       | F    | 1959-03-27 |
| Mary | Monarch        | F    | 1955-10-27 |
| Mary | Srimani        | M    | 1961-03-13 |
| Mary | Itzfeldt       | F    | 1953-11-06 |
| Mary | Babu           | F    | 1963-08-31 |
| Mary | Glinert        | F    | 1959-02-14 |
| Mary | Hofmeyr        | F    | 1952-10-06 |
| Mary | Milicic        | M    | 1963-12-13 |
| Mary | Hiroyama       | M    | 1952-11-29 |
| Mary | Lindenbaum     | F    | 1964-01-01 |
| Mary | Kalafatis      | F    | 1953-02-15 |
| Mary | Perz           | F    | 1955-07-25 |
| Mary | Nishimukai     | M    | 1960-11-01 |
| Mary | Ananiadou      | M    | 1963-10-06 |
| Mary | Holburn        | M    | 1955-01-22 |
| Mary | Pelz           | M    | 1954-12-17 |
| Mary | Hammerschmidt  | M    | 1952-05-19 |
| Mary | Gruenwald      | M    | 1957-01-14 |
| Mary | Siochi         | M    | 1962-10-05 |
| Mary | Kalefeld       | F    | 1960-07-02 |
| Mary | Chimia         | M    | 1952-02-03 |
| Mary | Ghalwash       | M    | 1963-09-11 |
| Mary | Puoti          | F    | 1954-05-04 |
| Mary | Ulupinar       | M    | 1959-03-30 |
| Mary | Gente          | F    | 1958-02-18 |
| Mary | Hasenauer      | M    | 1952-10-17 |
| Mary | Mitsuhashi     | M    | 1957-03-06 |
| Mary | Billingsley    | F    | 1955-12-01 |
| Mary | Hofman         | M    | 1962-08-11 |
| Mary | Lorch          | F    | 1957-01-28 |
| Mary | Danecki        | M    | 1952-02-10 |
| Mary | Molenkamp      | M    | 1955-10-10 |
| Mary | DasSarma       | M    | 1958-12-18 |
| Mary | Thiria         | M    | 1962-05-13 |
| Mary | Axelband       | M    | 1956-10-26 |
| Mary | Uhrik          | M    | 1955-12-02 |
| Mary | Bugaenko       | M    | 1955-08-19 |
| Mary | Shihab         | M    | 1963-01-29 |
| Mary | Yoshizawa      | M    | 1955-05-11 |
| Mary | Krichel        | M    | 1952-06-24 |
| Mary | Peha           | M    | 1962-03-09 |
| Mary | Czaja          | F    | 1955-06-29 |
| Mary | Katalagarianos | M    | 1960-07-01 |
| Mary | Heyers         | M    | 1952-05-27 |
| Mary | Schlegelmilch  | M    | 1953-02-24 |
| Mary | Wuwongse       | M    | 1964-08-09 |
| Mary | Servieres      | M    | 1963-03-24 |
| Mary | Perna          | F    | 1954-12-07 |
| Mary | Busillo        | M    | 1963-03-26 |
| Mary | Cronau         | F    | 1957-02-09 |
| Mary | Comellas       | M    | 1959-01-07 |
| Mary | Braunschweig   | M    | 1955-05-29 |
| Mary | Kampfer        | F    | 1956-03-10 |
| Mary | Carrere        | F    | 1964-06-07 |
| Mary | Ratnaker       | M    | 1953-10-19 |
| Mary | Gils           | M    | 1953-08-29 |
| Mary | Mitchem        | M    | 1953-03-03 |
| Mary | Pietrzykowski  | M    | 1961-10-06 |
| Mary | Tokunaga       | F    | 1960-06-24 |
| Mary | Stavenow       | F    | 1964-03-23 |
| Mary | Burnard        | F    | 1953-03-20 |
| Mary | Lamparter      | F    | 1953-02-27 |
| Mary | Speek          | M    | 1953-12-04 |
| Mary | Edelhoff       | M    | 1952-03-12 |
| Mary | Assaf          | F    | 1953-11-02 |
| Mary | Casley         | M    | 1961-08-28 |
| Mary | Bahk           | F    | 1952-08-29 |
| Mary | Schrooten      | M    | 1957-08-30 |
| Mary | Kornyak        | F    | 1957-10-03 |
| Mary | Jansen         | M    | 1961-03-26 |
| Mary | Weedman        | M    | 1959-07-15 |
| Mary | Cronin         | F    | 1953-11-17 |
| Mary | Kampfer        | M    | 1957-06-16 |
| Mary | Mitsuhashi     | M    | 1962-01-20 |
| Mary | Conti          | M    | 1962-02-27 |
| Mary | Staudhammer    | M    | 1960-08-06 |
| Mary | Keohane        | M    | 1952-12-29 |
| Mary | Kumaresan      | M    | 1958-02-24 |
| Mary | Mahmud         | M    | 1960-07-03 |
| Mary | Facello        | M    | 1953-10-11 |
| Mary | Birrer         | M    | 1964-05-16 |
| Mary | Nyanchama      | M    | 1956-05-15 |
| Mary | Baba           | F    | 1958-06-25 |
| Mary | Swift          | M    | 1957-05-29 |
| Mary | Showalter      | M    | 1953-01-05 |
| Mary | Tiemann        | M    | 1954-10-05 |
+------+----------------+------+------------+
96 rows in set (0.00 sec)

====================================================================================
* SQL
EXPLAIN
SELECT 이름, 성, 성별, 생년월일
FROM 사원
WHERE 소문자_이름= 'MARY'
AND 입사일자 >= '1990-01-01';

* 결과
+----+-------------+-------+------------+------+-------------------------+--------------+---------+-------+------+----------+-------------+
| id | select_type | table | partitions | type | possible_keys           | key          | key_len | ref   | rows | filtered | Extra       |
+----+-------------+-------+------------+------+-------------------------+--------------+---------+-------+------+----------+-------------+
|  1 | SIMPLE      | 사원  | NULL       | ref  | I_입사일자,I_소문자이름 | I_소문자이름 | 44      | const |  224 |    50.00 | Using where |
+----+-------------+-------+------------+------+-------------------------+--------------+---------+-------+------+----------+-------------+
1 row in set, 1 warning (0.00 sec)

====================================================================================
* SQL
ALTER TABLE 사원 DROP COLUMN 소문자_이름;

* 결과
Query OK, 0 rows affected (3.99 sec)
Records: 0  Duplicates: 0  Warnings: 0

====================================================================================
* SQL
mysql> desc 사원;

* 결과
+----------+---------------+------+-----+---------+-------+
| Field    | Type          | Null | Key | Default | Extra |
+----------+---------------+------+-----+---------+-------+
| 사원번호 | int           | NO   | PRI | NULL    |       |
| 생년월일 | date          | NO   |     | NULL    |       |
| 이름     | varchar(14)   | NO   |     | NULL    |       |
| 성       | varchar(16)   | NO   |     | NULL    |       |
| 성별     | enum('M','F') | NO   | MUL | NULL    |       |
| 입사일자 | date          | NO   | MUL | NULL    |       |
+----------+---------------+------+-----+---------+-------+
6 rows in set (0.01 sec)


====================================================================================
== 5.3.3. ==========================================================================
====================================================================================
* SQL
SELECT COUNT(1)
  FROM 급여
  WHERE 시작일자 BETWEEN STR_TO_DATE('2000-01-01', '%Y-%m-%d')
                     AND STR_TO_DATE('2000-12-31', '%Y-%m-%d');

* 결과
+----------+
| COUNT(1) |
+----------+
|   255785 |
+----------+
1 row in set (1.23 sec)

====================================================================================
* SQL
EXPLAIN
SELECT COUNT(1)
FROM 급여
WHERE 시작일자 BETWEEN STR_TO_DATE('2000-01-01', '%Y-%m-%d') 
AND STR_TO_DATE('2000-12-31', '%Y-%m-%d');
					
* 결과
+----+-------------+-------+------------+-------+--------------------+------------+---------+------+---------+----------+--------------------------+
| id | select_type | table | partitions | type  | possible_keys      | key        | key_len | ref  | rows    | filtered | Extra                    |
+----+-------------+-------+------------+-------+--------------------+------------+---------+------+---------+----------+--------------------------+
|  1 | SIMPLE      | 급여  | NULL       | index | PRIMARY,I_사용여부 | I_사용여부 | 4       | NULL | 2838731 |    11.11 | Using where; Using index |
+----+-------------+-------+------------+-------+--------------------+------------+---------+------+---------+----------+--------------------------+
1 row in set, 1 warning (0.00 sec)

====================================================================================
* SQL
SELECT COUNT(1)
FROM 급여;

* 결과
+----------+
| COUNT(1) |
+----------+
|  2844047 |
+----------+
1 row in set (3.76 sec)

====================================================================================
* SQL
SELECT YEAR(시작일자), COUNT(1)
FROM 급여
GROUP BY YEAR(시작일자);

* 결과
+----------------+----------+
| YEAR(시작일자) | COUNT(1) |
+----------------+----------+
|           1986 |    37957 |
|           1987 |    57440 |
|           1988 |    76896 |
|           1989 |    95957 |
|           1990 |   114561 |
|           1991 |   132624 |
|           1992 |   151072 |
|           1993 |   168139 |
|           1994 |   185159 |
|           1995 |   201637 |
|           1996 |   218309 |
|           1997 |   233190 |
|           1998 |   247489 |
|           1999 |   260957 |
|           2000 |   255785 |
|           2001 |   247652 |
|           1985 |    18293 |
|           2002 |   140930 |
+----------------+----------+
18 rows in set (1.45 sec)

====================================================================================
* SQL
ALTER TABLE 급여
partition by range COLUMNS (시작일자)
(
    partition p85 values less than ('1985-12-31'),
    partition p86 values less than ('1986-12-31'),
    partition p87 values less than ('1987-12-31'),
    partition p88 values less than ('1988-12-31'),
    partition p89 values less than ('1989-12-31'),
    partition p90 values less than ('1990-12-31'),
    partition p91 values less than ('1991-12-31'),
    partition p92 values less than ('1992-12-31'),
    partition p93 values less than ('1993-12-31'),
    partition p94 values less than ('1994-12-31'),
    partition p95 values less than ('1995-12-31'),
    partition p96 values less than ('1996-12-31'),
    partition p97 values less than ('1997-12-31'),
    partition p98 values less than ('1998-12-31'),
    partition p99 values less than ('1999-12-31'),
    partition p00 values less than ('2000-12-31'),
    partition p01 values less than ('2001-12-31'),
    partition p02 values less than ('2002-12-31'),
    partition p03 values less than (MAXVALUE)
);

* 결과
Query OK, 2844047 rows affected (23.66 sec)
Records: 2844047  Duplicates: 0  Warnings: 0

====================================================================================
* SQL
SELECT COUNT(1)
FROM 급여
WHERE 시작일자 BETWEEN STR_TO_DATE('2000-01-01', '%Y-%m-%d')
AND STR_TO_DATE('2000-12-31', '%Y-%m-%d');

* 결과
+----------+
| COUNT(1) |
+----------+
|   255785 |
+----------+
1 row in set (0.19 sec)

====================================================================================
* SQL
EXPLAIN
SELECT COUNT(1)
FROM 급여
WHERE 시작일자 BETWEEN STR_TO_DATE('2000-01-01', '%Y-%m-%d')
AND STR_TO_DATE('2000-12-31', '%Y-%m-%d');

* 결과
+----+-------------+-------+------------+-------+--------------------+------------+---------+------+--------+----------+--------------------------+
| id | select_type | table | partitions | type  | possible_keys      | key        | key_len | ref  | rows   | filtered | Extra                    |
+----+-------------+-------+------------+-------+--------------------+------------+---------+------+--------+----------+--------------------------+
|  1 | SIMPLE      | 급여  | p00,p01    | index | PRIMARY,I_사용여부 | I_사용여부 | 4       | NULL | 503433 |    11.11 | Using where; Using index |
+----+-------------+-------+------------+-------+--------------------+------------+---------+------+--------+----------+--------------------------+
1 row in set, 1 warning (0.00 sec)

====================================================================================
* SQL
ALTER TABLE 급여 REMOVE PARTITIONING;

* 결과
Query OK, 2844047 rows affected (2 min 8.77 sec)
Records: 2844047  Duplicates: 0  Warnings: 0