====================================================================================
== 4.1.1 ===========================================================================
====================================================================================
* SQL
SELECT COUNT(1)
FROM 급여;

* 결과
+----------+
| COUNT(1) |
+----------+
|  2844047 |
+----------+
1 row in set (3.69 sec)

====================================================================================
* SQL
SELECT COUNT(1)
FROM 부서;

* 결과
+----------+
| COUNT(1) |
+----------+
|        9 |
+----------+
1 row in set (0.00 sec)
====================================================================================
* SQL
SELECT COUNT(1)
FROM 부서관리자;

* 결과
+----------+
| COUNT(1) |
+----------+
|       24 |
+----------+
1 row in set (0.01 sec)
====================================================================================
* SQL
SELECT COUNT(1)
FROM 부서사원_매핑;

* 결과
+----------+
| COUNT(1) |
+----------+
|   331603 |
+----------+
1 row in set (1.89 sec)

====================================================================================
* SQL
SELECT COUNT(1)
FROM 사원;

* 결과
+----------+
| COUNT(1) |
+----------+
|   300024 |
+----------+
1 row in set (2.47 sec)
====================================================================================
* SQL
SELECT COUNT(1)
FROM 사원출입기록;

* 결과
+----------+
| COUNT(1) |
+----------+
|   660000 |
+----------+
1 row in set (1.78 sec)
====================================================================================
* SQL
SELECT COUNT(1)
FROM 직급;

* 결과
+----------+
| COUNT(1) |
+----------+
|   443308 |
+----------+
1 row in set (1.23 sec)
====================================================================================
* SQL
show index from 급여;

* 결과
+-------+------------+------------+--------------+-------------+-----------+-------------+----------+--------+------+------------+---------+---------------+---------+------------+
| Table | Non_unique | Key_name   | Seq_in_index | Column_name | Collation | Cardinality | Sub_part | Packed | Null | Index_type | Comment | Index_comment | Visible | Expression |
+-------+------------+------------+--------------+-------------+-----------+-------------+----------+--------+------+------------+---------+---------------+---------+------------+
| 급여  |          0 | PRIMARY    |            1 | 사원번호    | A         |      298323 |     NULL |   NULL |      | BTREE      |         |               | YES     | NULL       |
| 급여  |          0 | PRIMARY    |            2 | 시작일자    | A         |     2838731 |     NULL |   NULL |      | BTREE      |         |               | YES     | NULL       |
| 급여  |          1 | I_사용여부 |            1 | 사용여부    | A         |           1 |     NULL |   NULL | YES  | BTREE      |         |               | YES     | NULL       |
+-------+------------+------------+--------------+-------------+-----------+-------------+----------+--------+------+------------+---------+---------------+---------+------------+
3 rows in set (0.01 sec)
====================================================================================
* SQL
show index from 부서;

* 결과
+-------+------------+-----------+--------------+-------------+-----------+-------------+----------+--------+------+------------+---------+---------------+---------+------------+
| Table | Non_unique | Key_name  | Seq_in_index | Column_name | Collation | Cardinality | Sub_part | Packed | Null | Index_type | Comment | Index_comment | Visible | Expression |
+-------+------------+-----------+--------------+-------------+-----------+-------------+----------+--------+------+------------+---------+---------------+---------+------------+
| 부서  |          0 | PRIMARY   |            1 | 부서번호    | A         |           9 |     NULL |   NULL |      | BTREE      |         |               | YES     | NULL       |
| 부서  |          0 | UI_부서명 |            1 | 부서명      | A         |           9 |     NULL |   NULL |      | BTREE      |         |               | YES     | NULL       |
+-------+------------+-----------+--------------+-------------+-----------+-------------+----------+--------+------+------------+---------+---------------+---------+------------+
2 rows in set (0.00 sec)
====================================================================================
* SQL
show index from 부서관리자;

* 결과
+------------+------------+------------+--------------+-------------+-----------+-------------+----------+--------+------+------------+---------+---------------+---------+------------+
| Table      | Non_unique | Key_name   | Seq_in_index | Column_name | Collation | Cardinality | Sub_part | Packed | Null | Index_type | Comment | Index_comment | Visible | Expression |
+------------+------------+------------+--------------+-------------+-----------+-------------+----------+--------+------+------------+---------+---------------+---------+------------+
| 부서관리자 |          0 | PRIMARY    |            1 | 사원번호    | A         |          24 |     NULL |   NULL |      | BTREE      |         |               | YES     | NULL       |
| 부서관리자 |          0 | PRIMARY    |            2 | 부서번호    | A         |          24 |     NULL |   NULL |      | BTREE      |         |               | YES     | NULL       |
| 부서관리자 |          1 | I_부서번호 |            1 | 부서번호    | A         |           9 |     NULL |   NULL |      | BTREE      |         |               | YES     | NULL       |
+------------+------------+------------+--------------+-------------+-----------+-------------+----------+--------+------+------------+---------+---------------+---------+------------+
3 rows in set (0.00 sec)
====================================================================================
* SQL
show index from 부서사원_매핑;

* 결과
+---------------+------------+------------+--------------+-------------+-----------+-------------+----------+--------+------+------------+---------+---------------+---------+------------+
| Table         | Non_unique | Key_name   | Seq_in_index | Column_name | Collation | Cardinality | Sub_part | Packed | Null | Index_type | Comment | Index_comment | Visible | Expression |
+---------------+------------+------------+--------------+-------------+-----------+-------------+----------+--------+------+------------+---------+---------------+---------+------------+
| 부서사원_매핑 |          0 | PRIMARY    |            1 | 사원번호    | A         |      299417 |     NULL |   NULL |      | BTREE      |         |               | YES     | NULL       |
| 부서사원_매핑 |          0 | PRIMARY    |            2 | 부서번호    | A         |      331143 |     NULL |   NULL |      | BTREE      |         |               | YES     | NULL       |
| 부서사원_매핑 |          1 | I_부서번호 |            1 | 부서번호    | A         |           8 |     NULL |   NULL |      | BTREE      |         |               | YES     | NULL       |
+---------------+------------+------------+--------------+-------------+-----------+-------------+----------+--------+------+------------+---------+---------------+---------+------------+
3 rows in set (0.00 sec)
====================================================================================
* SQL
show index from 사원;

* 결과
+-------+------------+------------+--------------+-------------+-----------+-------------+----------+--------+------+------------+---------+---------------+---------+------------+
| Table | Non_unique | Key_name   | Seq_in_index | Column_name | Collation | Cardinality | Sub_part | Packed | Null | Index_type | Comment | Index_comment | Visible | Expression |
+-------+------------+------------+--------------+-------------+-----------+-------------+----------+--------+------+------------+---------+---------------+---------+------------+
| 사원  |          0 | PRIMARY    |            1 | 사원번호    | A         |      299157 |     NULL |   NULL |      | BTREE      |         |               | YES     | NULL       |
| 사원  |          1 | I_입사일자 |            1 | 입사일자    | A         |        4612 |     NULL |   NULL |      | BTREE      |         |               | YES     | NULL       |
| 사원  |          1 | I_성별_성  |            1 | 성별        | A         |           1 |     NULL |   NULL |      | BTREE      |         |               | YES     | NULL       |
| 사원  |          1 | I_성별_성  |            2 | 성          | A         |        3257 |     NULL |   NULL |      | BTREE      |         |               | YES     | NULL       |
+-------+------------+------------+--------------+-------------+-----------+-------------+----------+--------+------+------------+---------+---------------+---------+------------+
4 rows in set (0.00 sec)
====================================================================================
* SQL
show index from 사원출입기록;

* 결과
+--------------+------------+----------+--------------+-------------+-----------+-------------+----------+--------+------+------------+---------+---------------+---------+------------+
| Table        | Non_unique | Key_name | Seq_in_index | Column_name | Collation | Cardinality | Sub_part | Packed | Null | Index_type | Comment | Index_comment | Visible | Expression |
+--------------+------------+----------+--------------+-------------+-----------+-------------+----------+--------+------+------------+---------+---------------+---------+------------+
| 사원출입기록 |          0 | PRIMARY  |            1 | 순번        | A         |      658935 |     NULL |   NULL |      | BTREE      |         |               | YES     | NULL       |
| 사원출입기록 |          0 | PRIMARY  |            2 | 사원번호    | A         |      658935 |     NULL |   NULL |      | BTREE      |         |               | YES     | NULL       |
| 사원출입기록 |          1 | I_지역   |            1 | 지역        | A         |           4 |     NULL |   NULL | YES  | BTREE      |         |               | YES     | NULL       |
| 사원출입기록 |          1 | I_시간   |            1 | 입출입시간  | A         |      652638 |     NULL |   NULL |      | BTREE      |         |               | YES     | NULL       |
| 사원출입기록 |          1 | I_출입문 |            1 | 출입문      | A         |           3 |     NULL |   NULL | YES  | BTREE      |         |               | YES     | NULL       |
+--------------+------------+----------+--------------+-------------+-----------+-------------+----------+--------+------+------------+---------+---------------+---------+------------+
5 rows in set (0.00 sec)
====================================================================================
* SQL
show index from 직급;

* 결과
+-------+------------+----------+--------------+-------------+-----------+-------------+----------+--------+------+------------+---------+---------------+---------+------------+
| Table | Non_unique | Key_name | Seq_in_index | Column_name | Collation | Cardinality | Sub_part | Packed | Null | Index_type | Comment | Index_comment | Visible | Expression |
+-------+------------+----------+--------------+-------------+-----------+-------------+----------+--------+------+------------+---------+---------------+---------+------------+
| 직급  |          0 | PRIMARY  |            1 | 사원번호    | A         |      301768 |     NULL |   NULL |      | BTREE      |         |               | YES     | NULL       |
| 직급  |          0 | PRIMARY  |            2 | 직급명      | A         |      442605 |     NULL |   NULL |      | BTREE      |         |               | YES     | NULL       |
| 직급  |          0 | PRIMARY  |            3 | 시작일자    | A         |      442961 |     NULL |   NULL |      | BTREE      |         |               | YES     | NULL       |
+-------+------------+----------+--------------+-------------+-----------+-------------+----------+--------+------+------------+---------+---------------+---------+------------+
3 rows in set (0.00 sec)

====================================================================================
== 4.2.1 ===========================================================================
==================================================================================== 기본 키를 변형하는 나쁜 SQL 문
* SQL
SELECT *
FROM 사원
WHERE SUBSTRING(사원번호,1,4) = 1100
AND LENGTH(사원번호) = 5;

* 결과
+----------+------------+-------------+-------------+------+------------+
| 사원번호 | 생년월일   | 이름        | 성          | 성별 | 입사일자   |
+----------+------------+-------------+-------------+------+------------+
|    11000 | 1960-09-12 | Alain       | Bonifati    | M    | 1988-08-20 |
|    11001 | 1956-04-16 | Baziley     | Buchter     | F    | 1987-02-23 |
|    11002 | 1952-02-26 | Bluma       | Ulupinar    | M    | 1996-12-23 |
|    11003 | 1960-11-13 | Mariangiola | Gulla       | M    | 1987-05-24 |
|    11004 | 1954-08-05 | JoAnna      | Decleir     | F    | 1992-01-19 |
|    11005 | 1958-03-12 | Byong       | Douceur     | F    | 1986-07-27 |
|    11006 | 1962-12-26 | Christoper  | Butterworth | F    | 1989-08-02 |
|    11007 | 1962-03-16 | Olivera     | Maccarone   | M    | 1991-04-11 |
|    11008 | 1962-07-11 | Gennady     | Menhoudj    | M    | 1988-09-18 |
|    11009 | 1954-08-30 | Alper       | Axelband    | F    | 1986-09-09 |
+----------+------------+-------------+-------------+------+------------+
10 rows in set (0.21 sec)
====================================================================================
* SQL
EXPLAIN
SELECT *
FROM 사원
WHERE SUBSTRING(사원번호,1,4) = 1100
AND LENGTH(사원번호) = 5;

* 결과
+----+-------------+-------+------------+------+---------------+------+---------+------+--------+----------+-------------+
| id | select_type | table | partitions | type | possible_keys | key  | key_len | ref  | rows   | filtered | Extra       |
+----+-------------+-------+------------+------+---------------+------+---------+------+--------+----------+-------------+
|  1 | SIMPLE      | 사원  | NULL       | ALL  | NULL          | NULL | NULL    | NULL | 299157 |   100.00 | Using where |
+----+-------------+-------+------------+------+---------------+------+---------+------+--------+----------+-------------+
1 row in set, 1 warning (0.00 sec)

====================================================================================
* SQL
SELECT COUNT(1) FROM 사원;

* 결과
+----------+
| COUNT(1) |
+----------+
|   300024 |
+----------+
1 row in set (2.37 sec)
====================================================================================
* SQL
show index from 사원;

* 결과
+-------+------------+------------+--------------+-------------+-----------+-------------+----------+--------+------+------------+---------+---------------+---------+------------+
| Table | Non_unique | Key_name   | Seq_in_index | Column_name | Collation | Cardinality | Sub_part | Packed | Null | Index_type | Comment | Index_comment | Visible | Expression |
+-------+------------+------------+--------------+-------------+-----------+-------------+----------+--------+------+------------+---------+---------------+---------+------------+
| 사원  |          0 | PRIMARY    |            1 | 사원번호    | A         |      299157 |     NULL |   NULL |      | BTREE      |         |               | YES     | NULL       |
| 사원  |          1 | I_입사일자 |            1 | 입사일자    | A         |        4612 |     NULL |   NULL |      | BTREE      |         |               | YES     | NULL       |
| 사원  |          1 | I_성별_성  |            1 | 성별        | A         |           1 |     NULL |   NULL |      | BTREE      |         |               | YES     | NULL       |
| 사원  |          1 | I_성별_성  |            2 | 성          | A         |        3257 |     NULL |   NULL |      | BTREE      |         |               | YES     | NULL       |
+-------+------------+------------+--------------+-------------+-----------+-------------+----------+--------+------+------------+---------+---------------+---------+------------+
4 rows in set (0.00 sec)
====================================================================================

* SQL
SELECT *
FROM 사원
WHERE 사원번호 BETWEEN 11000 AND 11009;

* 결과
+----------+------------+-------------+-------------+------+------------+
| 사원번호 | 생년월일   | 이름        | 성          | 성별 | 입사일자   |
+----------+------------+-------------+-------------+------+------------+
|    11000 | 1960-09-12 | Alain       | Bonifati    | M    | 1988-08-20 |
|    11001 | 1956-04-16 | Baziley     | Buchter     | F    | 1987-02-23 |
|    11002 | 1952-02-26 | Bluma       | Ulupinar    | M    | 1996-12-23 |
|    11003 | 1960-11-13 | Mariangiola | Gulla       | M    | 1987-05-24 |
|    11004 | 1954-08-05 | JoAnna      | Decleir     | F    | 1992-01-19 |
|    11005 | 1958-03-12 | Byong       | Douceur     | F    | 1986-07-27 |
|    11006 | 1962-12-26 | Christoper  | Butterworth | F    | 1989-08-02 |
|    11007 | 1962-03-16 | Olivera     | Maccarone   | M    | 1991-04-11 |
|    11008 | 1962-07-11 | Gennady     | Menhoudj    | M    | 1988-09-18 |
|    11009 | 1954-08-30 | Alper       | Axelband    | F    | 1986-09-09 |
+----------+------------+-------------+-------------+------+------------+
10 rows in set (0.00 sec)
====================================================================================
* SQL
EXPLAIN
SELECT *
FROM 사원
WHERE 사원번호 BETWEEN 11000 AND 11009;

* 결과
+----+-------------+-------+------------+-------+---------------+---------+---------+------+------+----------+-------------+
| id | select_type | table | partitions | type  | possible_keys | key     | key_len | ref  | rows | filtered | Extra       |
+----+-------------+-------+------------+-------+---------------+---------+---------+------+------+----------+-------------+
|  1 | SIMPLE      | 사원  | NULL       | range | PRIMARY       | PRIMARY | 4       | NULL |   10 |   100.00 | Using where |
+----+-------------+-------+------------+-------+---------------+---------+---------+------+------+----------+-------------+
1 row in set, 1 warning (0.00 sec)

====================================================================================
== 4.2.2. ==========================================================================
====================================================================================
* SQL
SELECT IFNULL(성별,'NO DATA') AS 성별, COUNT(1) 건수
FROM 사원
GROUP BY IFNULL(성별,'NO DATA');

* 결과
+------+--------+
| 성별 | 건수   |
+------+--------+
| M    | 179973 |
| F    | 120051 |
+------+--------+
2 rows in set (0.77 sec)


====================================================================================
* SQL
EXPLAIN
SELECT IFNULL(성별,'NO DATA') AS 성별, COUNT(1) 건수
FROM 사원
GROUP BY IFNULL(성별,'NO DATA');

* 결과
+----+-------------+-------+------------+-------+---------------+-----------+---------+------+--------+----------+------------------------------+
| id | select_type | table | partitions | type  | possible_keys | key       | key_len | ref  | rows   | filtered | Extra                        |
+----+-------------+-------+------------+-------+---------------+-----------+---------+------+--------+----------+------------------------------+
|  1 | SIMPLE      | 사원  | NULL       | index | I_성별_성     | I_성별_성 | 51      | NULL | 299157 |   100.00 | Using index; Using temporary |
+----+-------------+-------+------------+-------+---------------+-----------+---------+------+--------+----------+------------------------------+
1 row in set, 1 warning (0.00 sec)
====================================================================================
* SQL
desc 사원;

* 결과
+----------+---------------+------+-----+---------+-------+
| Field    | Type          | Null | Key | Default | Extra |
+----------+---------------+------+-----+---------+-------+
| 사원번호 | int           | NO   | PRI | NULL    |       |
| 생년월일 | date          | NO   |     | NULL    |       |
| 이름     | varchar(14)   | NO   |     | NULL    |       |
| 성       | varchar(16)   | NO   |     | NULL    |       |
| 성별     | enum('M','F') | NO   | MUL | NULL    |       |
| 입사일자 | date          | NO   | MUL | NULL    |       |
+----------+---------------+------+-----+---------+-------+
6 rows in set (0.01 sec)

====================================================================================
* SQL
SELECT 성별, COUNT(1) 건수
FROM 사원
GROUP BY 성별;

* 결과
+------+--------+
| 성별 | 건수   |
+------+--------+
| M    | 179973 |
| F    | 120051 |
+------+--------+
2 rows in set (0.10 sec)

====================================================================================
* SQL
EXPLAIN
SELECT 성별, COUNT(1) 건수
FROM 사원
GROUP BY 성별;

* 결과
+----+-------------+-------+------------+-------+---------------+-----------+---------+------+--------+----------+-------------+
| id | select_type | table | partitions | type  | possible_keys | key       | key_len | ref  | rows   | filtered | Extra       |
+----+-------------+-------+------------+-------+---------------+-----------+---------+------+--------+----------+-------------+
|  1 | SIMPLE      | 사원  | NULL       | index | I_성별_성     | I_성별_성 | 51      | NULL | 299157 |   100.00 | Using index |
+----+-------------+-------+------------+-------+---------------+-----------+---------+------+--------+----------+-------------+
1 row in set, 1 warning (0.00 sec)

====================================================================================
== 4.2.3 ===========================================================================
====================================================================================
* SQL
SELECT COUNT(1)
FROM 급여
WHERE 사용여부 = 1;

* 결과
+----------+
| COUNT(1) |
+----------+
|    42842 |
+----------+
1 row in set (0.15 sec)

====================================================================================
* SQL
EXPLAIN
SELECT COUNT(1)
FROM 급여
WHERE 사용여부 = 1;

* 결과
+----+-------------+-------+------------+-------+---------------+------------+---------+------+---------+----------+--------------------------+
| id | select_type | table | partitions | type  | possible_keys | key        | key_len | ref  | rows    | filtered | Extra                    |
+----+-------------+-------+------------+-------+---------------+------------+---------+------+---------+----------+--------------------------+
|  1 | SIMPLE      | 급여  | NULL       | index | I_사용여부    | I_사용여부 | 4       | NULL | 2838731 |    10.00 | Using where; Using index |
+----+-------------+-------+------------+-------+---------------+------------+---------+------+---------+----------+--------------------------+
1 row in set, 3 warnings (0.00 sec)
====================================================================================
* SQL
SELECT 사용여부, COUNT(1)
FROM 급여
GROUP BY 사용여부;

* 결과
+----------+----------+
| 사용여부 | COUNT(1) |
+----------+----------+
| 0        |  2801205 |
| 1        |    42842 |
+----------+----------+
2 rows in set (0.15 sec)

====================================================================================
* SQL
show index from 급여;

* 결과
+-------+------------+------------+--------------+-------------+-----------+-------------+----------+--------+------+------------+---------+---------------+---------+------------+
| Table | Non_unique | Key_name   | Seq_in_index | Column_name | Collation | Cardinality | Sub_part | Packed | Null | Index_type | Comment | Index_comment | Visible | Expression |
+-------+------------+------------+--------------+-------------+-----------+-------------+----------+--------+------+------------+---------+---------------+---------+------------+
| 급여  |          0 | PRIMARY    |            1 | 사원번호    | A         |      298323 |     NULL |   NULL |      | BTREE      |         |               | YES     | NULL       |
| 급여  |          0 | PRIMARY    |            2 | 시작일자    | A         |     2838731 |     NULL |   NULL |      | BTREE      |         |               | YES     | NULL       |
| 급여  |          1 | I_사용여부 |            1 | 사용여부    | A         |           1 |     NULL |   NULL | YES  | BTREE      |         |               | YES     | NULL       |
+-------+------------+------------+--------------+-------------+-----------+-------------+----------+--------+------+------------+---------+---------------+---------+------------+
3 rows in set (0.01 sec)
====================================================================================
* SQL
desc 급여;

* 결과
+----------+---------+------+-----+---------+-------+
| Field    | Type    | Null | Key | Default | Extra |
+----------+---------+------+-----+---------+-------+
| 사원번호 | int     | NO   | PRI | NULL    |       |
| 연봉     | int     | NO   |     | NULL    |       |
| 시작일자 | date    | NO   | PRI | NULL    |       |
| 종료일자 | date    | NO   |     | NULL    |       |
| 사용여부 | char(1) | YES  | MUL |         |       |
+----------+---------+------+-----+---------+-------+
5 rows in set (0.01 sec)
====================================================================================
* SQL
SELECT COUNT(1)
FROM 급여
WHERE 사용여부 = '1';

* 결과
+----------+
| COUNT(1) |
+----------+
|    42842 |
+----------+
1 row in set (0.01 sec)

====================================================================================
* SQL
EXPLAIN
SELECT COUNT(1)
FROM 급여
WHERE 사용여부 = '1';

* 결과
+----+-------------+-------+------------+------+---------------+------------+---------+-------+-------+----------+-------------+
| id | select_type | table | partitions | type | possible_keys | key        | key_len | ref   | rows  | filtered | Extra       |
+----+-------------+-------+------------+------+---------------+------------+---------+-------+-------+----------+-------------+
|  1 | SIMPLE      | 급여  | NULL       | ref  | I_사용여부    | I_사용여부 | 4       | const | 82824 |   100.00 | Using index |
+----+-------------+-------+------------+------+---------------+------------+---------+-------+-------+----------+-------------+
1 row in set, 1 warning (0.00 sec)

====================================================================================
== 4.2.4. ==========================================================================
====================================================================================
* SQL
SELECT *                                                      
FROM 사원                                                     
WHERE CONCAT(성별,' ',성) = 'M Radwan';

* 결과
+----------+------------+-------------+--------+------+------------+
| 사원번호 | 생년월일   | 이름        | 성     | 성별 | 입사일자   |
+----------+------------+-------------+--------+------+------------+
|    10346 | 1963-01-29 | Aamod       | Radwan | M    | 1987-01-27 |
|    16491 | 1952-12-03 | Emdad       | Radwan | M    | 1988-05-28 |
|    18169 | 1954-09-21 | Nathalie    | Radwan | M    | 1998-03-04 |
... 중략 ...
|   485129 | 1963-03-23 | Jouni       | Radwan | M    | 1990-08-31 |
|   491504 | 1954-12-27 | Zeydy       | Radwan | M    | 1998-03-08 |
|   498822 | 1955-06-15 | Boutros     | Radwan | M    | 1989-06-13 |
+----------+------------+-------------+--------+------+------------+
102 rows in set (0.25 sec)
====================================================================================
* SQL
EXPLAIN
SELECT *
FROM 사원
WHERE CONCAT(성별,' ',성) = 'M Radwan';

* 결과
+----+-------------+-------+------------+------+---------------+------+---------+------+--------+----------+-------------+
| id | select_type | table | partitions | type | possible_keys | key  | key_len | ref  | rows   | filtered | Extra       |
+----+-------------+-------+------------+------+---------------+------+---------+------+--------+----------+-------------+
|  1 | SIMPLE      | 사원  | NULL       | ALL  | NULL          | NULL | NULL    | NULL | 299157 |   100.00 | Using where |
+----+-------------+-------+------------+------+---------------+------+---------+------+--------+----------+-------------+
1 row in set, 1 warning (0.00 sec)
====================================================================================
* SQL
SELECT CONCAT(성별,' ',성) '성별_성', COUNT(1)
FROM 사원
WHERE CONCAT(성별,' ',성) = 'M Radwan'

UNION ALL

SELECT '전체 데이터', COUNT(1)
FROM 사원;

* 결과
+-------------+----------+
| 성별_성     | COUNT(1) |
+-------------+----------+
| M Radwan    |      102 |
| 전체 데이터 |   300024 |
+-------------+----------+
2 rows in set (2.50 sec)


====================================================================================
* SQL
SELECT *
FROM 사원
WHERE 성별 = 'M'
AND 성 =  'Radwan';

* 결과
+----------+------------+-------------+--------+------+------------+
| 사원번호 | 생년월일   | 이름        | 성     | 성별 | 입사일자   |
+----------+------------+-------------+--------+------+------------+
|    10346 | 1963-01-29 | Aamod       | Radwan | M    | 1987-01-27 |
|    16491 | 1952-12-03 | Emdad       | Radwan | M    | 1988-05-28 |
|    18169 | 1954-09-21 | Nathalie    | Radwan | M    | 1998-03-04 |
... 중략 ...
|   485129 | 1963-03-23 | Jouni       | Radwan | M    | 1990-08-31 |
|   491504 | 1954-12-27 | Zeydy       | Radwan | M    | 1998-03-08 |
|   498822 | 1955-06-15 | Boutros     | Radwan | M    | 1989-06-13 |
+----------+------------+-------------+--------+------+------------+
102 rows in set (0.01 sec)
====================================================================================
* SQL
EXPLAIN
SELECT *
FROM 사원
WHERE 성별 = 'M'
AND 성 =  'Radwan';

* 결과
+----+-------------+-------+------------+------+---------------+-----------+---------+-------------+------+----------+-------+
| id | select_type | table | partitions | type | possible_keys | key       | key_len | ref         | rows | filtered | Extra |
+----+-------------+-------+------------+------+---------------+-----------+---------+-------------+------+----------+-------+
|  1 | SIMPLE      | 사원  | NULL       | ref  | I_성별_성     | I_성별_성 | 51      | const,const |  102 |   100.00 | NULL  |
+----+-------------+-------+------------+------+---------------+-----------+---------+-------------+------+----------+-------+
1 row in set, 1 warning (0.00 sec)


====================================================================================
== 4.2.5. ==========================================================================
====================================================================================
* SQL
SELECT DISTINCT 사원.사원번호, 이름, 성, 부서번호
FROM 사원
JOIN 부서관리자
ON (사원.사원번호 = 부서관리자. 사원번호);

* 결과
+----------+-------------+--------------+----------+
| 사원번호 | 이름        | 성           | 부서번호 |
+----------+-------------+--------------+----------+
|   110022 | Margareta   | Markovitch   | d001     |
|   110039 | Vishwani    | Minakawa     | d001     |
|   110085 | Ebru        | Alpin        | d002     |
|   110114 | Isamu       | Legleitner   | d002     |
|   110183 | Shirish     | Ossenbruggen | d003     |
|   110228 | Karsten     | Sigstam      | d003     |
|   110303 | Krassimir   | Wegerle      | d004     |
|   110344 | Rosine      | Cools        | d004     |
|   110386 | Shem        | Kieras       | d004     |
|   110420 | Oscar       | Ghazalie     | d004     |
|   110511 | DeForest    | Hagimont     | d005     |
|   110567 | Leon        | DasSarma     | d005     |
|   110725 | Peternela   | Onuegbe      | d006     |
|   110765 | Rutger      | Hofmeyr      | d006     |
|   110800 | Sanjoy      | Quadeer      | d006     |
|   110854 | Dung        | Pesch        | d006     |
|   111035 | Przemyslawa | Kaelbling    | d007     |
|   111133 | Hauke       | Zhang        | d007     |
|   111400 | Arie        | Staelin      | d008     |
|   111534 | Hilary      | Kambil       | d008     |
|   111692 | Tonny       | Butterworth  | d009     |
|   111784 | Marjo       | Giarratana   | d009     |
|   111877 | Xiaobin     | Spinelli     | d009     |
|   111939 | Yuchang     | Weedman      | d009     |
+----------+-------------+--------------+----------+
24 rows in set (0.00 sec)


====================================================================================
* SQL
EXPLAIN
SELECT DISTINCT 사원.사원번호, 이름, 성, 부서번호
FROM 사원
JOIN 부서관리자
ON (사원.사원번호 = 부서관리자. 사원번호);

* 결과
+----+-------------+------------+------------+--------+---------------+------------+---------+----------------------------+------+----------+------------------------------+
| id | select_type | table      | partitions | type   | possible_keys | key        | key_len | ref                        | rows | filtered | Extra                        |
+----+-------------+------------+------------+--------+---------------+------------+---------+----------------------------+------+----------+------------------------------+
|  1 | SIMPLE      | 부서관리자 | NULL       | index  | PRIMARY       | I_부서번호 | 12      | NULL                       |   24 |   100.00 | Using index; Using temporary |
|  1 | SIMPLE      | 사원       | NULL       | eq_ref | PRIMARY       | PRIMARY    | 4       | tuning.부서관리자.사원번호 |    1 |   100.00 | NULL                         |
+----+-------------+------------+------------+--------+---------------+------------+---------+----------------------------+------+----------+------------------------------+
2 rows in set, 1 warning (0.00 sec)
====================================================================================
* SQL
SELECT 사원.사원번호, 이름, 성, 부서번호
FROM 사원
JOIN 부서관리자
ON (사원.사원번호 = 부서관리자. 사원번호);
+----------+-------------+--------------+----------+
| 사원번호 | 이름        | 성           | 부서번호 |
+----------+-------------+--------------+----------+
|   110022 | Margareta   | Markovitch   | d001     |
|   110039 | Vishwani    | Minakawa     | d001     |
|   110085 | Ebru        | Alpin        | d002     |
|   110114 | Isamu       | Legleitner   | d002     |
|   110183 | Shirish     | Ossenbruggen | d003     |
|   110228 | Karsten     | Sigstam      | d003     |
|   110303 | Krassimir   | Wegerle      | d004     |
|   110344 | Rosine      | Cools        | d004     |
|   110386 | Shem        | Kieras       | d004     |
|   110420 | Oscar       | Ghazalie     | d004     |
|   110511 | DeForest    | Hagimont     | d005     |
|   110567 | Leon        | DasSarma     | d005     |
|   110725 | Peternela   | Onuegbe      | d006     |
|   110765 | Rutger      | Hofmeyr      | d006     |
|   110800 | Sanjoy      | Quadeer      | d006     |
|   110854 | Dung        | Pesch        | d006     |
|   111035 | Przemyslawa | Kaelbling    | d007     |
|   111133 | Hauke       | Zhang        | d007     |
|   111400 | Arie        | Staelin      | d008     |
|   111534 | Hilary      | Kambil       | d008     |
|   111692 | Tonny       | Butterworth  | d009     |
|   111784 | Marjo       | Giarratana   | d009     |
|   111877 | Xiaobin     | Spinelli     | d009     |
|   111939 | Yuchang     | Weedman      | d009     |
+----------+-------------+--------------+----------+
24 rows in set (0.00 sec)

====================================================================================
* SQL
EXPLAIN
SELECT 사원.사원번호, 이름, 성, 부서번호
FROM 사원
JOIN 부서관리자
ON (사원.사원번호 = 부서관리자. 사원번호);

* 결과
+----+-------------+------------+------------+--------+---------------+------------+---------+----------------------------+------+----------+-------------+
| id | select_type | table      | partitions | type   | possible_keys | key        | key_len | ref                        | rows | filtered | Extra       |
+----+-------------+------------+------------+--------+---------------+------------+---------+----------------------------+------+----------+-------------+
|  1 | SIMPLE      | 부서관리자 | NULL       | index  | PRIMARY       | I_부서번호 | 12      | NULL                       |   24 |   100.00 | Using index |
|  1 | SIMPLE      | 사원       | NULL       | eq_ref | PRIMARY       | PRIMARY    | 4       | tuning.부서관리자.사원번호 |    1 |   100.00 | NULL        |
+----+-------------+------------+------------+--------+---------------+------------+---------+----------------------------+------+----------+-------------+
2 rows in set, 1 warning (0.00 sec)

====================================================================================
== 4.2.6. ==========================================================================
====================================================================================
* SQL
SELECT 'M' AS 성별, 사원번호
  FROM 사원 
 WHERE 성별 = 'M'
   AND 성 ='Baba'

 UNION

SELECT 'F', 사원번호
  FROM 사원
 WHERE 성별 = 'F'
   AND 성 = 'Baba';

* 결과
+------+----------+
| 성별 | 사원번호 |
+------+----------+
| M    |    11937 |
| M    |    12245 |
| M    |    15596 |
... 중략 ...
| F    |   496003 |
| F    |   498356 |
| F    |   499779 |
+------+----------+
226 rows in set (0.01 sec)
====================================================================================
* SQL
EXPLAIN
SELECT 'M' AS 성별, 사원번호
  FROM 사원 
 WHERE 성별 = 'M'
   AND 성 ='Baba'

 UNION

SELECT 'F', 사원번호
  FROM 사원
 WHERE 성별 = 'F'
   AND 성 = 'Baba';
   
* 결과
+------+--------------+------------+------------+------+---------------+-----------+---------+-------------+------+----------+-----------------+
| id   | select_type  | table      | partitions | type | possible_keys | key       | key_len | ref         | rows | filtered | Extra           |
+------+--------------+------------+------------+------+---------------+-----------+---------+-------------+------+----------+-----------------+
|  1   | PRIMARY      | 사원       | NULL       | ref  | I_성별_성     | I_성별_성 | 51      | const,const |  135 |   100.00 | Using index     |
|  2   | UNION        | 사원       | NULL       | ref  | I_성별_성     | I_성별_성 | 51      | const,const |   91 |   100.00 | Using index     |
| NULL | UNION RESULT | <union1,2> | NULL       | ALL  | NULL          | NULL      | NULL    | NULL        | NULL |     NULL | Using temporary |
+------+--------------+------------+------------+------+---------------+-----------+---------+-------------+------+----------+-----------------+
3 rows in set, 1 warning (0.00 sec)
====================================================================================
* SQL
show index from 사원;

* 결과
+-------+------------+------------+--------------+-------------+-----------+-------------+----------+--------+------+------------+---------+---------------+---------+------------+
| Table | Non_unique | Key_name   | Seq_in_index | Column_name | Collation | Cardinality | Sub_part | Packed | Null | Index_type | Comment | Index_comment | Visible | Expression |
+-------+------------+------------+--------------+-------------+-----------+-------------+----------+--------+------+------------+---------+---------------+---------+------------+
| 사원  |          0 | PRIMARY    |            1 | 사원번호    | A         |      299157 |     NULL |   NULL |      | BTREE      |         |               | YES     | NULL       |
| 사원  |          1 | I_입사일자 |            1 | 입사일자    | A         |        4612 |     NULL |   NULL |      | BTREE      |         |               | YES     | NULL       |
| 사원  |          1 | I_성별_성  |            1 | 성별        | A         |           1 |     NULL |   NULL |      | BTREE      |         |               | YES     | NULL       |
| 사원  |          1 | I_성별_성  |            2 | 성          | A         |        3257 |     NULL |   NULL |      | BTREE      |         |               | YES     | NULL       |
+-------+------------+------------+--------------+-------------+-----------+-------------+----------+--------+------+------------+---------+---------------+---------+------------+
4 rows in set (0.00 sec)
====================================================================================
* SQL
SELECT 'M' as 성별, 사원번호
  FROM 사원 
 WHERE 성별 = 'M'
   AND 성 ='Baba'

 UNION ALL

SELECT 'F' as 성별, 사원번호
  FROM 사원
 WHERE 성별 = 'F'
   AND 성 ='Baba';

* 결과
+------+----------+
| 성별 | 사원번호 |
+------+----------+
| M    |    11937 |
| M    |    12245 |
| M    |    15596 |
... 중략 ...
| F    |   496003 |
| F    |   498356 |
| F    |   499779 |
+------+----------+
226 rows in set (0.00 sec)
====================================================================================
* SQL
EXPLAIN
SELECT 'M' as 성별, 사원번호
  FROM 사원 
 WHERE 성별 = 'M'
   AND 성 ='Baba'

 UNION ALL

SELECT 'F' as 성별, 사원번호
  FROM 사원
 WHERE 성별 = 'F'
   AND 성 ='Baba';
   
* 결과
+----+-------------+-------+------------+------+---------------+-----------+---------+-------------+------+----------+-------------+
| id | select_type | table | partitions | type | possible_keys | key       | key_len | ref         | rows | filtered | Extra       |
+----+-------------+-------+------------+------+---------------+-----------+---------+-------------+------+----------+-------------+
|  1 | PRIMARY     | 사원  | NULL       | ref  | I_성별_성     | I_성별_성 | 51      | const,const |  135 |   100.00 | Using index |
|  2 | UNION       | 사원  | NULL       | ref  | I_성별_성     | I_성별_성 | 51      | const,const |   91 |   100.00 | Using index |
+----+-------------+-------+------------+------+---------------+-----------+---------+-------------+------+----------+-------------+
2 rows in set, 1 warning (0.00 sec)
====================================================================================
== 4.2.7. ==========================================================================
====================================================================================
* SQL
SELECT 성, 성별, COUNT(1) as 카운트
  FROM 사원
 GROUP BY 성, 성별;

* 결과
+------------------+------+--------+
| 성               | 성별 | 카운트 |
+------------------+------+--------+
| Aamodt           | M    |    120 |
| Acton            | M    |    108 |
| Adachi           | M    |    140 |
... 중략 ...
| Zwicker          | F    |     65 |
| Zyda             | F    |     72 |
| Zykh             | F    |     61 |
+------------------+------+--------+
3274 rows in set (0.43 sec)


====================================================================================
* SQL
EXPLAIN
SELECT 성, 성별, COUNT(1) as 카운트
FROM 사원
GROUP BY 성, 성별;

* 결과
+----+-------------+-------+------------+-------+---------------+-----------+---------+------+--------+----------+------------------------------+
| id | select_type | table | partitions | type  | possible_keys | key       | key_len | ref  | rows   | filtered | Extra                        |
+----+-------------+-------+------------+-------+---------------+-----------+---------+------+--------+----------+------------------------------+
|  1 | SIMPLE      | 사원  | NULL       | index | I_성별_성     | I_성별_성 | 51      | NULL | 299157 |   100.00 | Using index; Using temporary |
+----+-------------+-------+------------+-------+---------------+-----------+---------+------+--------+----------+------------------------------+
1 row in set, 1 warning (0.00 sec)
====================================================================================
* SQL
show index from 사원;

* 결과
+-------+------------+------------+--------------+-------------+-----------+-------------+----------+--------+------+------------+---------+---------------+---------+------------+
| Table | Non_unique | Key_name   | Seq_in_index | Column_name | Collation | Cardinality | Sub_part | Packed | Null | Index_type | Comment | Index_comment | Visible | Expression |
+-------+------------+------------+--------------+-------------+-----------+-------------+----------+--------+------+------------+---------+---------------+---------+------------+
| 사원  |          0 | PRIMARY    |            1 | 사원번호    | A         |      299157 |     NULL |   NULL |      | BTREE      |         |               | YES     | NULL       |
| 사원  |          1 | I_입사일자 |            1 | 입사일자    | A         |        4612 |     NULL |   NULL |      | BTREE      |         |               | YES     | NULL       |
| 사원  |          1 | I_성별_성  |            1 | 성별        | A         |           1 |     NULL |   NULL |      | BTREE      |         |               | YES     | NULL       |
| 사원  |          1 | I_성별_성  |            2 | 성          | A         |        3257 |     NULL |   NULL |      | BTREE      |         |               | YES     | NULL       |
+-------+------------+------------+--------------+-------------+-----------+-------------+----------+--------+------+------------+---------+---------------+---------+------------+
4 rows in set (0.00 sec)
====================================================================================
* SQL
SELECT 성, 성별, COUNT(1) as 카운트
FROM 사원
GROUP BY 성별, 성;

* 결과
+------------------+------+--------+
| 성               | 성별 | 카운트 |
+------------------+------+--------+
| Aamodt           | M    |    120 |
| Acton            | M    |    108 |
| Adachi           | M    |    140 |
... 중략 ...
| Zwicker          | F    |     65 |
| Zyda             | F    |     72 |
| Zykh             | F    |     61 |
+------------------+------+--------+
3274 rows in set (0.04 sec)
====================================================================================
* SQL
EXPLAIN
SELECT 성, 성별, COUNT(1) as 카운트
FROM 사원
GROUP BY 성별, 성;

* 결과
+----+-------------+-------+------------+-------+---------------+-----------+---------+------+--------+----------+-------------+
| id | select_type | table | partitions | type  | possible_keys | key       | key_len | ref  | rows   | filtered | Extra       |
+----+-------------+-------+------------+-------+---------------+-----------+---------+------+--------+----------+-------------+
|  1 | SIMPLE      | 사원  | NULL       | index | I_성별_성     | I_성별_성 | 51      | NULL | 299157 |   100.00 | Using index |
+----+-------------+-------+------------+-------+---------------+-----------+---------+------+--------+----------+-------------+
1 row in set, 1 warning (0.00 sec)
====================================================================================
== 4.2.8. ==========================================================================
====================================================================================
* SQL
SELECT 사원번호
FROM 사원
WHERE 입사일자 LIKE '1989%'
AND 사원번호 > 100000;

* 결과
+----------+
| 사원번호 |    
+----------+
|   100011 |
|   100028 |
|   100041 |
... 중략 ...
|   499974 |
|   499983 |
|   499991 |
+----------+
20001 rows in set (0.13 sec)

====================================================================================
* SQL
EXPLAIN
SELECT 사원번호
FROM 사원
WHERE 입사일자 LIKE '1989%'
AND 사원번호 > 100000;

* 결과
+----+-------------+-------+------------+-------+--------------------+---------+---------+------+--------+----------+-------------+
| id | select_type | table | partitions | type  | possible_keys      | key     | key_len | ref  | rows   | filtered | Extra       |
+----+-------------+-------+------------+-------+--------------------+---------+---------+------+--------+----------+-------------+
|  1 | SIMPLE      | 사원  | NULL       | range | PRIMARY,I_입사일자 | PRIMARY | 4       | NULL | 149578 |    11.11 | Using where |
+----+-------------+-------+------------+-------+--------------------+---------+---------+------+--------+----------+-------------+
1 row in set, 1 warning (0.00 sec)
====================================================================================
* SQL
show index from 사원;

* 결과
+-------+------------+------------+--------------+-------------+-----------+-------------+----------+--------+------+------------+---------+---------------+---------+------------+
| Table | Non_unique | Key_name   | Seq_in_index | Column_name | Collation | Cardinality | Sub_part | Packed | Null | Index_type | Comment | Index_comment | Visible | Expression |
+-------+------------+------------+--------------+-------------+-----------+-------------+----------+--------+------+------------+---------+---------------+---------+------------+
| 사원  |          0 | PRIMARY    |            1 | 사원번호    | A         |      299157 |     NULL |   NULL |      | BTREE      |         |               | YES     | NULL       |
| 사원  |          1 | I_입사일자 |            1 | 입사일자    | A         |        4612 |     NULL |   NULL |      | BTREE      |         |               | YES     | NULL       |
| 사원  |          1 | I_성별_성  |            1 | 성별        | A         |           1 |     NULL |   NULL |      | BTREE      |         |               | YES     | NULL       |
| 사원  |          1 | I_성별_성  |            2 | 성          | A         |        3257 |     NULL |   NULL |      | BTREE      |         |               | YES     | NULL       |
+-------+------------+------------+--------------+-------------+-----------+-------------+----------+--------+------+------------+---------+---------------+---------+------------+
4 rows in set (0.00 sec)
====================================================================================
* SQL
SELECT COUNT(1) FROM 사원;

* 결과
+----------+
| COUNT(1) |
+----------+
|   300024 |
+----------+
1 row in set (2.58 sec)

====================================================================================
* SQL
SELECT COUNT(1) FROM 사원 WHERE 입사일자 LIKE '1989%';

* 결과
+----------+
| COUNT(1) |
+----------+
|    28394 |
+----------+
1 row in set (0.16 sec)
====================================================================================
* SQL
SELECT COUNT(1) FROM 사원 WHERE 사원번호 > 100000;

* 결과
+----------+
| count(1) |
+----------+
|   210024 |
+----------+
1 row in set (0.12 sec)

====================================================================================
* SQL
EXPLAIN
SELECT 사원번호
FROM 사원 USE INDEX(I_입사일자)
WHERE 입사일자 LIKE '1989%'
AND 사원번호 > 100000;

* 결과
+----+-------------+-------+------------+-------+---------------+------------+---------+------+-------+----------+----------------------------------------+
| id | select_type | table | partitions | type  | possible_keys | key        | key_len | ref  | rows  | filtered | Extra                                  |
+----+-------------+-------+------------+-------+---------------+------------+---------+------+-------+----------+----------------------------------------+
|  1 | SIMPLE      | 사원  | NULL       | range | I_입사일자    | I_입사일자 | 7       | NULL | 99709 |   100.00 | Using where; Using index for skip scan |
+----+-------------+-------+------------+-------+---------------+------------+---------+------+-------+----------+----------------------------------------+
1 row in set, 1 warning (0.00 sec)
====================================================================================
* SQL
SELECT 사원번호
FROM 사원 USE INDEX(I_입사일자)
WHERE 입사일자 LIKE '1989%'
AND 사원번호 > 100000;

* 결과
+----------+
| 사원번호 |    
+----------+
|   100011 |
|   100028 |
|   100041 |
... 중략 ...
|   499974 |
|   499983 |
|   499991 |
+----------+
20001 rows in set (0.11 sec)
====================================================================================
* SQL
SELECT 사원번호
FROM 사원
WHERE 입사일자 >= '1989-01-01' AND 입사일자 < '1990-01-01'
AND 사원번호 > 100000;

* 결과
+----------+
| 사원번호 |    
+----------+
|   100011 |
|   100028 |
|   100041 |
... 중략 ...
|   499974 |
|   499983 |
|   499991 |
+----------+
20001 rows in set (0.01 sec)
====================================================================================
* SQL
EXPLAIN
SELECT 사원번호
FROM 사원
WHERE 입사일자 >= '1989-01-01' AND 입사일자 < '1990-01-01'
AND 사원번호 > 100000;

* 결과
+----+-------------+-------+------------+-------+--------------------+------------+---------+------+-------+----------+--------------------------+
| id | select_type | table | partitions | type  | possible_keys      | key        | key_len | ref  | rows  | filtered | Extra                    |
+----+-------------+-------+------------+-------+--------------------+------------+---------+------+-------+----------+--------------------------+
|  1 | SIMPLE      | 사원  | NULL       | range | PRIMARY,I_입사일자 | I_입사일자 | 7       | NULL | 49820 |    50.00 | Using where; Using index |
+----+-------------+-------+------------+-------+--------------------+------------+---------+------+-------+----------+--------------------------+
1 row in set, 1 warning (0.00 sec)
====================================================================================
== 4.2.9. ========================================================================== 
====================================================================================
* SQL
SELECT *
FROM 사원출입기록
WHERE 출입문 = 'B';

* 결과
+---------+----------+---------------------+------------+--------+------+
| 순번    | 사원번호 | 입출입시간          | 입출입구분 | 출입문 | 지역 |
+---------+----------+---------------------+------------+--------+------+
|  983026 |   110022 | 2020-05-26 11:16:28 | I          | B      | b    |
|  983027 |   110085 | 2020-09-05 01:20:57 | I          | B      | b    |
|  983028 |   110183 | 2020-03-09 20:55:22 | I          | B      | b    |
... 중략 ...
| 983033 |   111400 | 2020-08-03 08:41:13 | I          | B      | b    |
| 983034 |   111692 | 2020-07-12 04:42:28 | I          | B      | b    |
| 983035 |   110114 | 2020-11-15 21:28:40 | I          | B      | b    |
+--------+----------+---------------------+------------+--------+------+
300000 rows in set (3.70 sec)
====================================================================================
* SQL
EXPLAIN
SELECT *
FROM 사원출입기록
WHERE 출입문 = 'B';

* 결과
+----+-------------+--------------+------------+------+---------------+----------+---------+-------+--------+----------+-------+
| id | select_type | table        | partitions | type | possible_keys | key      | key_len | ref   | rows   | filtered | Extra |
+----+-------------+--------------+------------+------+---------------+----------+---------+-------+--------+----------+-------+
|  1 | SIMPLE      | 사원출입기록 | NULL       | ref  | I_출입문      | I_출입문 | 4       | const | 329467 |   100.00 | NULL  |
+----+-------------+--------------+------------+------+---------------+----------+---------+-------+--------+----------+-------+
1 row in set, 1 warning (0.02 sec)
====================================================================================
* SQL
SELECT 출입문, COUNT(1)
FROM 사원출입기록
GROUP BY 출입문;

* 결과
+--------+----------+
| 출입문 | COUNT(1) |
+--------+----------+
| A      |   250000 |
| B      |   300000 |
| C      |    10000 |
| D      |   100000 |
+--------+----------+
4 rows in set (0.24 sec)
====================================================================================
* SQL
SELECT *
FROM 사원출입기록 IGNORE INDEX(I_출입문)
WHERE 출입문 = 'B';

* 결과
+---------+----------+---------------------+------------+--------+------+
| 순번    | 사원번호 | 입출입시간          | 입출입구분 | 출입문 | 지역 |
+---------+----------+---------------------+------------+--------+------+
|  983026 |   110022 | 2020-05-26 11:16:28 | I          | B      | b    |
|  983027 |   110085 | 2020-09-05 01:20:57 | I          | B      | b    |
|  983028 |   110183 | 2020-03-09 20:55:22 | I          | B      | b    |
... 중략 ...
| 983033 |   111400 | 2020-08-03 08:41:13 | I          | B      | b    |
| 983034 |   111692 | 2020-07-12 04:42:28 | I          | B      | b    |
| 983035 |   110114 | 2020-11-15 21:28:40 | I          | B      | b    |
+--------+----------+---------------------+------------+--------+------+
300000 rows in set (0.85 sec)
====================================================================================
* SQL
EXPLAIN
SELECT *
FROM 사원출입기록 IGNORE INDEX(I_출입문)
WHERE 출입문 = 'B';

* 결과
+----+-------------+--------------+------------+------+---------------+------+---------+------+--------+----------+-------------+
| id | select_type | table        | partitions | type | possible_keys | key  | key_len | ref  | rows   | filtered | Extra       |
+----+-------------+--------------+------------+------+---------------+------+---------+------+--------+----------+-------------+
|  1 | SIMPLE      | 사원출입기록 | NULL       | ALL  | NULL          | NULL | NULL    | NULL | 658935 |    10.00 | Using where |
+----+-------------+--------------+------------+------+---------------+------+---------+------+--------+----------+-------------+
1 row in set, 1 warning (0.00 sec)
====================================================================================
== 4.2.10. =========================================================================
====================================================================================
* SQL
SELECT 이름, 성
FROM 사원
WHERE 입사일자 BETWEEN STR_TO_DATE('1994-01-01', '%Y-%m-%d') 
AND STR_TO_DATE('2000-12-31', '%Y-%m-%d');

* 결과
+----------------+------------------+
| 이름           | 성               |
+----------------+------------------+
| Saniya         | Kalloufi         |
| Kazuhito       | Cappelletti      |
| Lillian        | Haddadi          |
... 중략 ...
| Rimli          | Dusink           |
| DeForest       | Mullainathan     |
| Sachin         | Tsukuda          |
+----------------+------------------+
48875 rows in set (1.21 sec)

====================================================================================
* SQL
EXPLAIN
SELECT 이름, 성
FROM 사원
WHERE 입사일자 BETWEEN STR_TO_DATE('1994-01-01', '%Y-%m-%d') 
AND STR_TO_DATE('2000-12-31', '%Y-%m-%d');

* 결과
+----+-------------+-------+------------+-------+---------------+------------+---------+------+--------+----------+----------------------------------+
| id | select_type | table | partitions | type  | possible_keys | key        | key_len | ref  | rows   | filtered | Extra                            |
+----+-------------+-------+------------+-------+---------------+------------+---------+------+--------+----------+----------------------------------+
|  1 | SIMPLE      | 사원  | NULL       | range | I_입사일자    | I_입사일자 | 3       | NULL | 112160 |   100.00 | Using index condition; Using MRR |
+----+-------------+-------+------------+-------+---------------+------------+---------+------+--------+----------+----------------------------------+
1 row in set, 1 warning (0.01 sec)
====================================================================================
* SQL
select count(1) from 사원;

* 결과
+----------+
| count(1) |
+----------+
|   300024 |
+----------+
1 row in set (2.30 sec)
====================================================================================
* SQL
SELECT 이름, 성
FROM 사원
WHERE YEAR(입사일자) BETWEEN '1994' AND '2000';

* 결과
+----------------+------------------+
| 이름           | 성               |
+----------------+------------------+
| Saniya         | Kalloufi         |
| Kazuhito       | Cappelletti      |
| Lillian        | Haddadi          |
... 중략 ...
| Rimli          | Dusink           |
| DeForest       | Mullainathan     |
| Sachin         | Tsukuda          |
+----------------+------------------+
48875 rows in set (0.20 sec)
====================================================================================
* SQL
EXPLAIN
SELECT 이름, 성
FROM 사원
WHERE YEAR(입사일자) BETWEEN '1994' AND '2000';

* 결과
+----+-------------+-------+------------+------+---------------+------+---------+------+--------+----------+-------------+
| id | select_type | table | partitions | type | possible_keys | key  | key_len | ref  | rows   | filtered | Extra       |
+----+-------------+-------+------------+------+---------------+------+---------+------+--------+----------+-------------+
|  1 | SIMPLE      | 사원  | NULL       | ALL  | NULL          | NULL | NULL    | NULL | 299157 |   100.00 | Using where |
+----+-------------+-------+------------+------+---------------+------+---------+------+--------+----------+-------------+
1 row in set, 1 warning (0.00 sec)

====================================================================================
== 4.3.1. ==========================================================================
====================================================================================
* SQL
SELECT 매핑.사원번호, 부서.부서번호
FROM 부서사원_매핑 매핑, 부서
WHERE 매핑.부서번호 = 부서.부서번호
AND 매핑.시작일자 >= '2002-03-01';

* 결과
+----------+----------+
| 사원번호 | 부서번호 |
+----------+----------+
|    11732 | d009     |
|    14179 | d009     |
|    16989 | d009     |
... 중략 ...
|   483592 | d007     |
|   487945 | d007     |
|   488117 | d007     |
+----------+----------+
1341 rows in set (13.27 sec)
====================================================================================
* SQL
EXPLAIN
SELECT 매핑.사원번호, 부서.부서번호
FROM 부서사원_매핑 매핑,부서
WHERE 매핑.부서번호 = 부서.부서번호
AND 매핑.시작일자 >= '2002-03-01';

* 결과
+----+-------------+-------+------------+-------+---------------+------------+---------+----------------------+-------+----------+-------------+
| id | select_type | table | partitions | type  | possible_keys | key        | key_len | ref                  | rows  | filtered | Extra       |
+----+-------------+-------+------------+-------+---------------+------------+---------+----------------------+-------+----------+-------------+
|  1 | SIMPLE      | 부서  | NULL       | index | PRIMARY       | UI_부서명  | 122     | NULL                 |     9 |   100.00 | Using index |
|  1 | SIMPLE      | 매핑  | NULL       | ref   | I_부서번호    | I_부서번호 | 12      | tuning.부서.부서번호 | 41392 |    33.33 | Using where |
+----+-------------+-------+------------+-------+---------------+------------+---------+----------------------+-------+----------+-------------+
2 rows in set, 1 warning (0.00 sec)
====================================================================================
* SQL
SELECT COUNT(1) FROM 부서사원_매핑;

* 결과
+----------+
| COUNT(1) |
+----------+
|   331603 |
+----------+
1 row in set (1.94 sec)

====================================================================================

* SQL
SELECT COUNT(1) FROM 부서;

* 결과
+----------+
| COUNT(1) |
+----------+
|        9 |
+----------+
1 row in set (0.01 sec)

====================================================================================

* SQL
SELECT COUNT(1) FROM 부서사원_매핑 WHERE 시작일자>='2002-03-01';

* 결과
+----------+
| COUNT(1) |
+----------+
|     1341 |
+----------+
1 row in set (0.27 sec)

====================================================================================
* SQL
SELECT STRAIGHT_JOIN 매핑.사원번호, 부서.부서번호
FROM 부서사원_매핑 매핑, 부서
WHERE 매핑.부서번호 = 부서.부서번호
AND 매핑.시작일자 >= '2002-03-01' ;

* 결과
+----------+----------+
| 사원번호 | 부서번호 |
+----------+----------+
|    11732 | d009     |
|    14179 | d009     |
|    16989 | d009     |
... 중략 ...
|   483592 | d007     |
|   487945 | d007     |
|   488117 | d007     |
+----------+----------+
1341 rows in set (0.17 sec)
====================================================================================
* SQL
EXPLAIN
SELECT STRAIGHT_JOIN 매핑.사원번호, 부서.부서번호
FROM 부서사원_매핑 매핑, 부서
WHERE 매핑.부서번호 = 부서.부서번호
AND 매핑.시작일자 >= '2002-03-01';

* 결과
+----+-------------+-------+------------+--------+---------------+---------+---------+----------------------+--------+----------+-------------+
| id | select_type | table | partitions | type   | possible_keys | key     | key_len | ref                  | rows   | filtered | Extra       |
+----+-------------+-------+------------+--------+---------------+---------+---------+----------------------+--------+----------+-------------+
|  1 | SIMPLE      | 매핑  | NULL       | ALL    | I_부서번호    | NULL    | NULL    | NULL                 | 331143 |    33.33 | Using where |
|  1 | SIMPLE      | 부서  | NULL       | eq_ref | PRIMARY       | PRIMARY | 12      | tuning.매핑.부서번호 |      1 |   100.00 | Using index |
+----+-------------+-------+------------+--------+---------------+---------+---------+----------------------+--------+----------+-------------+
2 rows in set, 1 warning (0.00 sec)

====================================================================================
== 4.3.2. ==========================================================================
====================================================================================
* SQL
SELECT 사원.사원번호, 사원.이름, 사원.성
  FROM 사원
 WHERE 사원번호 > 450000
   AND ( SELECT MAX(연봉)
           FROM 급여
          WHERE 사원번호 = 사원.사원번호
       ) > 100000;

* 결과
+----------+----------------+------------------+
| 사원번호 | 이름           | 성               |
+----------+----------------+------------------+
|   450025 | Dharmaraja     | Marrevee         |
|   450040 | Iara           | Falby            |
|   450044 | Steen          | Broder           |
... 중략 ...
|   499980 | Gino           | Usery            |
|   499986 | Nathan         | Ranta            |
|   499988 | Bangqing       | Kleiser          |
+----------+----------------+------------------+
3155 rows in set (0.57 sec)

====================================================================================
* SQL
EXPLAIN
SELECT 사원.사원번호, 사원.이름, 사원.성
  FROM 사원
 WHERE 사원번호 > 450000
   AND ( SELECT MAX(연봉)
           FROM 급여
          WHERE 사원번호 = 사원.사원번호
       ) > 100000;
	   
* 결과
+----+--------------------+-------+------------+-------+---------------+---------+---------+----------------------+--------+----------+-------------+
| id | select_type        | table | partitions | type  | possible_keys | key     | key_len | ref                  | rows   | filtered | Extra       |
+----+--------------------+-------+------------+-------+---------------+---------+---------+----------------------+--------+----------+-------------+
|  1 | PRIMARY            | 사원  | NULL       | range | PRIMARY       | PRIMARY | 4       | NULL                 | 104330 |   100.00 | Using where |
|  2 | DEPENDENT SUBQUERY | 급여  | NULL       | ref   | PRIMARY       | PRIMARY | 4       | tuning.사원.사원번호 |      9 |   100.00 | NULL        |
+----+--------------------+-------+------------+-------+---------------+---------+---------+----------------------+--------+----------+-------------+
2 rows in set, 2 warnings (0.01 sec)
====================================================================================
* SQL
SELECT COUNT(1) FROM 사원;

* 결과
+----------+
| COUNT(1) |
+----------+
|   300024 |
+----------+
1 row in set (2.28 sec)
====================================================================================
* SQL
SELECT COUNT(1) FROM 급여;

* 결과
+----------+
| COUNT(1) |
+----------+
|  2844047 |
+----------+
1 row in set (1.32 sec)
====================================================================================
* SQL
SELECT COUNT(1)
FROM 사원
WHERE 사원번호 > 450000;

* 결과
+----------+
| COUNT(1) |
+----------+
|    49999 |
+----------+
1 row in set (0.03 sec)

====================================================================================
* SQL
show index from 사원;

* 결과
+-------+------------+------------+--------------+-------------+-----------+-------------+----------+--------+------+------------+---------+---------------+---------+------------+
| Table | Non_unique | Key_name   | Seq_in_index | Column_name | Collation | Cardinality | Sub_part | Packed | Null | Index_type | Comment | Index_comment | Visible | Expression |
+-------+------------+------------+--------------+-------------+-----------+-------------+----------+--------+------+------------+---------+---------------+---------+------------+
| 사원  |          0 | PRIMARY    |            1 | 사원번호    | A         |      299157 |     NULL |   NULL |      | BTREE      |         |               | YES     | NULL       |
| 사원  |          1 | I_입사일자 |            1 | 입사일자    | A         |        4612 |     NULL |   NULL |      | BTREE      |         |               | YES     | NULL       |
| 사원  |          1 | I_성별_성  |            1 | 성별        | A         |           1 |     NULL |   NULL |      | BTREE      |         |               | YES     | NULL       |
| 사원  |          1 | I_성별_성  |            2 | 성          | A         |        3257 |     NULL |   NULL |      | BTREE      |         |               | YES     | NULL       |
+-------+------------+------------+--------------+-------------+-----------+-------------+----------+--------+------+------------+---------+---------------+---------+------------+
4 rows in set (0.00 sec)
====================================================================================
* SQL
show index from 급여;

* 결과
+-------+------------+------------+--------------+-------------+-----------+-------------+----------+--------+------+------------+---------+---------------+---------+------------+
| Table | Non_unique | Key_name   | Seq_in_index | Column_name | Collation | Cardinality | Sub_part | Packed | Null | Index_type | Comment | Index_comment | Visible | Expression |
+-------+------------+------------+--------------+-------------+-----------+-------------+----------+--------+------+------------+---------+---------------+---------+------------+
| 급여  |          0 | PRIMARY    |            1 | 사원번호    | A         |      298323 |     NULL |   NULL |      | BTREE      |         |               | YES     | NULL       |
| 급여  |          0 | PRIMARY    |            2 | 시작일자    | A         |     2838731 |     NULL |   NULL |      | BTREE      |         |               | YES     | NULL       |
| 급여  |          1 | I_사용여부 |            1 | 사용여부    | A         |           1 |     NULL |   NULL | YES  | BTREE      |         |               | YES     | NULL       |
+-------+------------+------------+--------------+-------------+-----------+-------------+----------+--------+------+------------+---------+---------------+---------+------------+
3 rows in set (0.01 sec)

====================================================================================
* SQL
SELECT 사원.사원번호,
       사원.이름,
       사원.성
  FROM 사원,
       급여
 WHERE 사원.사원번호 > 450000
   AND 사원.사원번호 = 급여.사원번호
 GROUP BY 사원.사원번호
HAVING MAX(급여.연봉) > 100000;

* 결과
+----------+----------------+------------------+
| 사원번호 | 이름           | 성               |
+----------+----------------+------------------+
|   450025 | Dharmaraja     | Marrevee         |
|   450040 | Iara           | Falby            |
|   450044 | Steen          | Broder           |
... 중략 ...
|   499980 | Gino           | Usery            |
|   499986 | Nathan         | Ranta            |
|   499988 | Bangqing       | Kleiser          |
+----------+----------------+------------------+
3155 rows in set (0.11 sec)


====================================================================================
* SQL
EXPLAIN
SELECT 사원.사원번호,
       사원.이름,
       사원.성
  FROM 사원,
       급여
 WHERE 사원.사원번호 > 450000
   AND 사원.사원번호 = 급여.사원번호
 GROUP BY 사원.사원번호
HAVING MAX(급여.연봉) > 100000;

* 결과
+----+-------------+-------+------------+-------+------------------------------+---------+---------+----------------------+--------+----------+-------------+
| id | select_type | table | partitions | type  | possible_keys                | key     | key_len | ref                  | rows   | filtered | Extra       |
+----+-------------+-------+------------+-------+------------------------------+---------+---------+----------------------+--------+----------+-------------+
|  1 | SIMPLE      | 사원  | NULL       | range | PRIMARY,I_입사일자,I_성별_성 | PRIMARY | 4       | NULL                 | 104330 |   100.00 | Using where |
|  1 | SIMPLE      | 급여  | NULL       | ref   | PRIMARY                      | PRIMARY | 4       | tuning.사원.사원번호 |      9 |   100.00 | NULL        |
+----+-------------+-------+------------+-------+------------------------------+---------+---------+----------------------+--------+----------+-------------+
2 rows in set, 1 warning (0.01 sec)

====================================================================================
== 4.3.3. ==========================================================================
====================================================================================
* SQL
SELECT COUNT(DISTINCT 사원.사원번호) as 데이터건수
  FROM 사원,
       ( SELECT 사원번호
           FROM 사원출입기록 기록
          WHERE 출입문 = 'A'
       ) 기록
 WHERE 사원.사원번호 = 기록.사원번호;

* 결과
+------------+
| 데이터건수 |
+------------+
|     150000 |
+------------+
1 row in set (22.50 sec)

====================================================================================
* SQL
EXPLAIN
SELECT COUNT(DISTINCT 사원.사원번호) as 데이터건수
  FROM 사원,
       ( SELECT 사원번호
           FROM 사원출입기록 기록
          WHERE 출입문 = 'A'
       ) 기록
 WHERE 사원.사원번호 = 기록.사원번호;
 
* 결과
+----+-------------+-------+------------+--------+---------------+----------+---------+----------------------+--------+----------+-------------+
| id | select_type | table | partitions | type   | possible_keys | key      | key_len | ref                  | rows   | filtered | Extra       |
+----+-------------+-------+------------+--------+---------------+----------+---------+----------------------+--------+----------+-------------+
|  1 | SIMPLE      | 기록  | NULL       | ref    | I_출입문      | I_출입문 | 4       | const                | 329467 |   100.00 | Using index |
|  1 | SIMPLE      | 사원  | NULL       | eq_ref | PRIMARY       | PRIMARY  | 4       | tuning.기록.사원번호 |      1 |   100.00 | Using index |
+----+-------------+-------+------------+--------+---------------+----------+---------+----------------------+--------+----------+-------------+
2 rows in set, 1 warning (0.00 sec)
====================================================================================
* SQL
DESC 사원;

* 결과
+----------+---------------+------+-----+---------+-------+
| Field    | Type          | Null | Key | Default | Extra |
+----------+---------------+------+-----+---------+-------+
| 사원번호 | int           | NO   | PRI | NULL    |       |
| 생년월일 | date          | NO   |     | NULL    |       |
| 이름     | varchar(14)   | NO   |     | NULL    |       |
| 성       | varchar(16)   | NO   |     | NULL    |       |
| 성별     | enum('M','F') | NO   | MUL | NULL    |       |
| 입사일자 | date          | NO   | MUL | NULL    |       |
+----------+---------------+------+-----+---------+-------+
6 rows in set (0.01 sec)
====================================================================================
* SQL
SELECT COUNT(1) as 데이터건수
  FROM 사원
 WHERE EXISTS (SELECT 1
                 FROM 사원출입기록 기록
                WHERE 출입문 = 'A'
                AND 기록.사원번호 = 사원.사원번호);

* 결과
+------------+
| 데이터건수 |
+------------+
|     150000 |
+------------+
1 row in set (0.45 sec)

====================================================================================
* SQL
EXPLAIN
SELECT COUNT(1) as 데이터건수
  FROM 사원
 WHERE EXISTS (SELECT 1
                 FROM 사원출입기록 기록
                WHERE 출입문 = 'A'
                AND 기록.사원번호 = 사원.사원번호);
				
* 결과
+----+--------------+-------------+------------+--------+---------------------+---------------------+---------+----------------------+--------+----------+--------------------------+
| id | select_type  | table       | partitions | type   | possible_keys       | key                 | key_len | ref                  | rows   | filtered | Extra                    |
+----+--------------+-------------+------------+--------+---------------------+---------------------+---------+----------------------+--------+----------+--------------------------+
|  1 | SIMPLE       | 사원        | NULL       | index  | PRIMARY             | I_입사일자          | 3       | NULL                 | 299157 |   100.00 | Using where; Using index |
|  1 | SIMPLE       | <subquery2> | NULL       | eq_ref | <auto_distinct_key> | <auto_distinct_key> | 4       | tuning.사원.사원번호 |      1 |   100.00 | NULL                     |
|  2 | MATERIALIZED | 기록        | NULL       | ref    | I_출입문            | I_출입문            | 4       | const                | 329467 |   100.00 | Using index              |
+----+--------------+-------------+------------+--------+---------------------+---------------------+---------+----------------------+--------+----------+--------------------------+
3 rows in set, 2 warnings (0.00 sec)	