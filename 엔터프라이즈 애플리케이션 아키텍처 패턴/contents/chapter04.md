# 4장. 웹 프레젠테이션
웹 앱을 준비하는 작업은 서버 소프트웨어를 구성하는 것부터 시작한다. 일반적으로 서버는 특정 프로그램이 URL을 지정하는 일종의 구성 파일을 이용한다. 한 웹 서버가 다양한 종류의 프로그램을 처리할 수 있으며, 이러한 프로그램은 일반적으로 적절한 디렉터리에 넣는 방법으로 동적으로 서버로 추가할 수 있다.

웹 서버의 역할은 요청을 받으면 URL을 해석하고 웹 서버 프로그램으로 제어권을 넘겨주는 것이다. 웹 서버에서 프로그램을 구성하는 방식에는 스크립트와 서버 페이지라는 두 가지 주요 형식이 있다.

- 스크립트 형식
  - 일반적으로 HTTP 호출을 처리하는 함수나 메서드를 포함하는 프로그램으로서 CGI 스크립트와 Java Servlet을 예로 들 수 있다.
  - 스크립트는 문자열 형식의 HTTP 요청 객체를 조사하는 방법으로 웹 페이지로부터 데이터를 얻는다.
  - 웹 서버의 출력은 요청과 마찬가지로 응답이라는 문자열이며, 스크립트가 언어의 일반 출력 스트림 작업을 통해 출력할 수 있다.
  - 스트림 명령을 통해 HTML 응답을 작성하는 일은 상당히 불편하다.
  - 요청을 해석하는 데 적합하다.
- 서버 페이지
  - 반환되는 텍스트 페이지와 함께 프로그램 코드를 구성한다.
  - 반환하는 페이지는 HTML로 작성하고 특정 시점에 실행할 코드를 HTML scriptlet으로 삽입한다.
  - PHP, ASP, JSP 등이 있다.
  - 응답을 포매팅하는 데 적합하다.

<img width="614" alt="image" src="https://github.com/alanhakhyeonsong/LetsReadBooks/assets/60968342/9daf51af-1222-4d98-be33-84ceb2691ce8">

- 입력 컨트롤러는 요청을 받고 요청에서 정보를 꺼낸다.
- 비즈니스 논리를 적절한 모델 객체로 전달
- 모델 객체는 데이터 원본 객체와 통신하고 요청에 명시된 모든 작업을 수행한 다음 응답에 필요한 정보를 수집한다.
- 작업이 완료되면 입력 컨트롤러로 제어를 반환한다.
- 입력 컨트롤러는 응답 데이터와 함께 제어를 뷰로 전달

모델 뷰 컨트롤러를 적용하는 가장 중요한 이유는 **모델을 웹 프레젠테이션으로부터 완전히 분리하기 위해서다.** 그러면 프레젠테이션을 수정하는 것이나 나중에 다른 프레젠테이션을 추가하기도 쉽다.

처리를 별도의 트랜잭션 스크립트나 도메인 모델 객체에서 수행하면 테스트하기도 수월하다.

컨트롤러라는 용어는 다른 의미로 사용되기도 한다.
- 여러 사용자 인터페이스 설계에선 프레젠테이션 객체를 도메인 객체로부터 분리하기 위해 애플리케이션 컨트롤러 객체라는 중간 계층을 사용한다.
  - 애플리케이션의 흐름을 처리하고 어떤 화면을 어떤 순서로 표시할지 결정하는 역할.
  - 모든 프레젠테이션과 독립적으로 만들 수 있으며, 프레젠테이션 간 재사용이 가능함.
  - 이 구조는 동일한 기본 흐름의 여러 다른 프레젠테이션이 있을 때도 잘 동작하지만 다른 프레젠테이션에는 다른 흐름을 적용하는 것이 가장 좋다.
  - 모든 시스템에 이 객체가 필요한 것은 아니다.

## 뷰 패턴
- 변환 뷰
  - 페이지의 구조 안에 프레젠테이션을 작성하고 페이지에 표식을 삽입해 동적 콘텐츠를 넣을 위치를 지정할 수 있다.
  - ASP, JSP, PHP
  - 상당히 강력하고 유연하지만, 관리하기 어려운 복잡한 코드로 이어질 가능성이 높다.
  - 도우미 객체를 활용하는 등의 방법으로 페이지 구조에서 프로그래밍 논리를 철저하게 배제하도록 노력하는게 좋다.
- 템플릿 뷰
  - 변환 스타일의 프로그램을 사용.
  - XSTL
- 1단계 뷰
  - 애플리케이션 화면 당 뷰 컴포넌트 하나를 사용한다.
  - 뷰는 도메인에서 데이터를 받고 이를 HTML로 렌더링한다.
  - 서로 비슷한 논리적 화면이 뷰를 공유하는 경우는 있지만 이 경우에도 화면당 뷰 하나가 사용된다고 간주함.
- 2단계 뷰
  - 도메인 데이터로부터 논리적 화면을 생성한 다음 이를 HTML로 렌더링 하는 두 단계로 나눈다.
  - 뷰는 전체 애플리케이션에 하나만 있다.
  - 사용할 HTML에 대한 결정을 한 곳으로 모을 수 있는 장점이 있다.
  - 한 객체만 변경하면 사이트의 모든 화면을 변경할 수 있으므로 HTML 전체를 쉽게 변경할 수 있다.
  - 단, 논리적 프레젠테이션이 동일하게 유지돼야 하므로 여러 화면이 동일한 기본 레이아웃을 사용하는 사이트에 가장 적합하다.

## 입력 컨트롤러 패턴
입력 컨트롤러엔 두 가지 패턴이 있다.

- 가장 일반적인 패턴은 웹 사이트의 모든 페이지마다 입력 컨트롤러 객체를 만드는 것.
  - 페이지 컨트롤러가 뷰와 입력 컨트롤러의 역할을 결합한 서버 페이지 하나인 경우
  - 버튼이나 링크와 같은 각 작업당 페이지가 컨트롤러 하나가 연결된다 보는 것이지만, 조건에 따라 여러 다른 페이지로 연결되는 링크와 같이 일대일 관계가 아닌 경우도 있다.
- 프런트 컨트롤러
  - 모든 입력 컨트롤러는 HTTP 요청을 처리하고 이를 바탕으로 수행할 작업을 결정하는 두 역할을 하므로 두 역할을 분리하는게 더 적절하다.
  - 서버 페이지는 요청을 처리하고 별도의 도우미 객체에 수행할 작업을 결정하도록 위임한다.
  - 프런트 컨트롤러는 URL을 해석해 요청의 유형을 파악하고 이를 처리할 별도의 객체를 생성한다.
  - 모든 HTTP 처리를 단일 객체로 집중하고 사이트의 작업 구조를 변경할 때마다 웹 서버를 다시 구성할 필요가 없게 만들 수 있다.