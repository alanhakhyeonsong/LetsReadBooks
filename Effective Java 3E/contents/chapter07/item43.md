# 아이템 43. 람다보다는 메서드 참조를 사용하라

## 메서드 참조

람다가 익명 클래스보다 나은 점 중 가장 큰 특징은 간결함이다. Java에는 함수 객체를 심지어 람다보다도 더 간결하게 만드는 방법이 있는데, 이는 **메서드 참조(method reference)다.**

```java
// 키가 맵안에 없다면 키와 숫자 1을 매핑하고, 이미 있다면 기존 매핑 값을 증가시킨다.
map.merge(key, 1, (count, incr) -> count +incr);
```

위 코드는 Java 8때 `Map`에 추가된 `merge` 메서드를 사용했다. `merge` 메서드의 전형적인 쓰임을 잘 보여주는 예제이지만, 매개변수인 count와 incr은 크게 하는 일 없이 공간을 꽤 차지한다.

Java 8이 되면서 `Integer` 클래스(와 모든 기본 타입의 박싱 타입)는 이 람다와 기능이 같은 정적 메서드 `sum`을 제공하기 시작했다. 따라서 람다 대신 이 메서드의 참조를 전달하면 똑같은 결과를 더 보기 좋게 얻을 수 있다.

```java
map.merge(key, 1, Integer::sum);
```

**매개변수 수가 늘어날수록 메서드 참조로 제거할 수 있는 코드 양도 늘어난다.**

## 람다와 메서드 참조

람다로 할 수 없는 일이라면 메서드 참조로도 할 수 없다.  
보통은 메서드 참조를 사용하는 편이 더 짧고 간결하므로, 람다로 구현했을 때 너무 길거나 복잡하다면 메서드 참조가 좋은 대안이 되어준다.

**때론 람다가 메서드 참조보다 간결할 때가 있다. 주로 메서드와 람다가 같은 클래스에 있을 때 그렇다.**

```java
// 메서드 참조
service.execute(GoshThisClassNameIsHumongous::action);

// 람다
service.execute(() -> action());
```

위 코드 예시에선 메서드 참조 쪽은 더 짧지도, 더 명확하지도 않다. 따라서 람다 쪽이 낫다.

## 메서드 참조의 유형

| 메서드 참조 유형    | 예                        | 같은 기능을 하는 람다                                 |
| ------------------- | ------------------------- | ----------------------------------------------------- |
| 정적                | `Integer::parseInt`       | `str -> Integer.parseInt(str)`                        |
| 한정적(인스턴스)    | `Instance.now()::isAfter` | `Instance then = Instant.now(); t -> then.isAfter(t)` |
| 비한정적 (인스턴스) | `String::toLowerCase`     | `str -> str.toLowerCase()`                            |
| 클래스 생성자       | `TreeMap<K,V>::new`       | `() -> new TreeMap<K,V>()`                            |
| 배열 생성자         | `int[]::new`              | `len -> new int[len]`                                 |

한정적 참조는 근본적으로 정적 참조와 비슷하다. 함수 객체가 받는 인수와 참조되는 메서드가 받는 인수가 똑같다.

비한정적 참조에서는 함수 객체를 적용하는 시점에 수신 객체를 알려준다. 이를 위해 수신 객체 전달용 매개변수가 매개변수 목록의 첫 번째로 추가되며, 그 뒤로는 참조되는 메서드 선언에 정의된 매개변수들이 뒤따른다. 비한정적 참조는 주로 스트림 파이프라인에서의 매핑과 필터 함수에 쓰인다.

클래스 생성자를 가리키는 메서드 참조와 배열 생성자를 가리키는 메서드 참조와 같이 생성자 참조는 팩터리 객체로 사용된다.

## 핵심 정리

- 메서드 참조는 람다의 간단명료한 대안이 될 수 있다.
- **메서드 참조 쪽이 짧고 명확하다면 메서드 참조를 쓰고, 그렇지 않을 때만 람다를 사용하라.**
